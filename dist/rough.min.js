var rough=function(){"use strict";function e(){return{LEFT:0,RIGHT:1,INTERSECTS:2,AHEAD:3,BEHIND:4,SEPARATE:5,UNDEFINED:6}}var t=Math.round,a=Math.pow,l=Math.floor,n=Math.cos,i=Math.sin,r=Math.PI,p=Math.sqrt,s=Math.max,h=Math.min,u=Math.abs,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},d=function(){function e(e,t){for(var a,l=0;l<t.length;l++)a=t[l],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),f=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},y=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e},c=function(){function t(a,n,i,s){g(this,t),this.RoughSegmentRelationConst=e(),this.px1=a,this.py1=n,this.px2=i,this.py2=s,this.xi=l,this.yi=l,this.a=s-n,this.b=a-i,this.c=i*n-a*s,this._undefined=0==this.a&&0==this.b&&0==this.c}var l=Number.MAX_VALUE;return d(t,[{key:"isUndefined",value:function(){return this._undefined}},{key:"compare",value:function(e){if(this.isUndefined()||e.isUndefined())return this.RoughSegmentRelationConst.UNDEFINED;var t=l,n=l,i=0,o=0,r=this.a,p=this.b,d=this.c;return(1e-5<u(p)&&(t=-r/p,i=-d/p),1e-5<u(e.b)&&(n=-e.a/e.b,o=-e.c/e.b),t==l)?n==l?-d/r==-e.c/e.a?this.py1>=h(e.py1,e.py2)&&this.py1<=s(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.py2>=h(e.py1,e.py2)&&this.py2<=s(e.py1,e.py2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=this.px1,this.yi=n*this.xi+o,-1e-5>(this.py1-this.yi)*(this.yi-this.py2)||-1e-5>(e.py1-this.yi)*(this.yi-e.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>u(e.a)?-1e-5>(e.px1-this.xi)*(this.xi-e.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS:this.RoughSegmentRelationConst.INTERSECTS):n==l?(this.xi=e.px1,this.yi=t*this.xi+i,-1e-5>(e.py1-this.yi)*(this.yi-e.py2)||-1e-5>(this.py1-this.yi)*(this.yi-this.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>u(r)?-1e-5>(this.px1-this.xi)*(this.xi-this.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS:this.RoughSegmentRelationConst.INTERSECTS):t==n?i==o?this.px1>=h(e.px1,e.px2)&&this.px1<=s(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.px2>=h(e.px1,e.px2)&&this.px2<=s(e.px1,e.px2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=(o-i)/(t-n),this.yi=t*this.xi+i,-1e-5>(this.px1-this.xi)*(this.xi-this.px2)||-1e-5>(e.px1-this.xi)*(this.xi-e.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS)}},{key:"getLength",value:function(){return this._getLength(this.px1,this.py1,this.px2,this.py2)}},{key:"_getLength",value:function(e,t,a,l){var n=a-e,i=l-t;return p(n*n+i*i)}}]),t}(),_=function(){function t(e,a,l,n,i,s,o,r){g(this,t),this.top=e,this.bottom=a,this.left=l,this.right=n,this.gap=i,this.sinAngle=s,this.tanAngle=r,1e-4>u(s)?this.pos=l+i:.9999<u(s)?this.pos=e+i:(this.deltaX=(a-e)*u(r),this.pos=l-u(this.deltaX),this.hGap=u(i/o),this.sLeft=new c(l,a,l,e),this.sRight=new c(n,a,n,e))}return d(t,[{key:"getNextLine",value:function(){if(1e-4>u(this.sinAngle)){if(this.pos<this.right){var t=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,t}}else if(!(.9999<u(this.sinAngle))){var a=this.pos-this.deltaX/2,l=this.pos+this.deltaX/2,n=this.bottom,i=this.top;if(this.pos<this.right+this.deltaX){for(;a<this.left&&l<this.left||a>this.right&&l>this.right;)if(this.pos+=this.hGap,a=this.pos-this.deltaX/2,l=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;var o=new c(a,n,l,i);o.compare(this.sLeft)==e().INTERSECTS&&(a=o.xi,n=o.yi),o.compare(this.sRight)==e().INTERSECTS&&(l=o.xi,i=o.yi),0<this.tanAngle&&(a=this.right-(a-this.left),l=this.right-(l-this.left));var s=[a,n,l,i];return this.pos+=this.hGap,s}}else if(this.pos<this.bottom){var r=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,r}return null}}]),t}(),v=function(){function e(t,a){g(this,e),this.type=t,this.text=a}return d(e,[{key:"isType",value:function(e){return this.type===e}}]),e}(),k=function(){function e(t){g(this,e),this.PARAMS={A:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],a:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],C:["x1","y1","x2","y2","x","y"],c:["x1","y1","x2","y2","x","y"],H:["x"],h:["x"],L:["x","y"],l:["x","y"],M:["x","y"],m:["x","y"],Q:["x1","y1","x","y"],q:["x1","y1","x","y"],S:["x2","y2","x","y"],s:["x2","y2","x","y"],T:["x","y"],t:["x","y"],V:["y"],v:["y"],Z:[],z:[]},this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.d=t||"",this.parseData(t),this.processPoints()}return d(e,[{key:"loadFromSegments",value:function(e){this.segments=e,this.processPoints()}},{key:"processPoints",value:function(){for(var e,t=null,a=[0,0],l=0;l<this.segments.length;l++){switch(e=this.segments[l],e.key){case"M":case"L":case"T":e.point=[e.data[0],e.data[1]];break;case"m":case"l":case"t":e.point=[e.data[0]+a[0],e.data[1]+a[1]];break;case"H":e.point=[e.data[0],a[1]];break;case"h":e.point=[e.data[0]+a[0],a[1]];break;case"V":e.point=[a[0],e.data[0]];break;case"v":e.point=[a[0],e.data[0]+a[1]];break;case"z":case"Z":t&&(e.point=[t[0],t[1]]);break;case"C":e.point=[e.data[4],e.data[5]];break;case"c":e.point=[e.data[4]+a[0],e.data[5]+a[1]];break;case"S":e.point=[e.data[2],e.data[3]];break;case"s":e.point=[e.data[2]+a[0],e.data[3]+a[1]];break;case"Q":e.point=[e.data[2],e.data[3]];break;case"q":e.point=[e.data[2]+a[0],e.data[3]+a[1]];break;case"A":e.point=[e.data[5],e.data[6]];break;case"a":e.point=[e.data[5]+a[0],e.data[6]+a[1]];}("m"===e.key||"M"===e.key)&&(t=null),e.point&&(a=e.point,!t&&(t=e.point)),("z"===e.key||"Z"===e.key)&&(t=null)}}},{key:"parseData",value:function(e){var t=this.tokenize(e),a=0,l=t[a],n="BOD";for(this.segments=[];!l.isType(this.EOD);){var s,o=[];if("BOD"!=n)l.isType(this.NUMBER)?s=this.PARAMS[n].length:(a++,s=this.PARAMS[l.text].length,n=l.text);else if("M"==l.text||"m"==l.text)a++,s=this.PARAMS[l.text].length,n=l.text;else return this.parseData("M0,0"+e);if(a+s<t.length){for(var r,p=a;p<a+s;p++)if(r=t[p],r.isType(this.NUMBER))o[o.length]=r.text;else return void console.error("Parameter type is not a number: "+n+","+r.text);var i;if(this.PARAMS[n])i={key:n,data:o};else return void console.error("Unsupported segment type: "+n);this.segments.push(i),a+=s,l=t[a],"M"==n&&(n="L"),"m"==n&&(n="l")}else console.error("Path data ended before all parameters were found")}}},{key:"tokenize",value:function(e){for(var t=[];""!=e;)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]=new v(this.COMMAND,RegExp.$1),e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]=new v(this.NUMBER,parseFloat(RegExp.$1)),e=e.substr(RegExp.$1.length);else return console.error("Unrecognized segment command: "+e),null;return t[t.length]=new v(this.EOD,null),t}},{key:"closed",get:function(){if("undefined"==typeof this._closed){this._closed=!1;var e,t=!0,a=!1;try{for(var l,n,i=this.segments[Symbol.iterator]();!(t=(l=i.next()).done);t=!0)n=l.value,"z"===n.key.toLowerCase()&&(this._closed=!0)}catch(t){a=!0,e=t}finally{try{!t&&i.return&&i.return()}finally{if(a)throw e}}}return this._closed}}]),e}(),x=function(){function e(t){g(this,e),this.d=t,this.parsed=new k(t),this._position=[0,0],this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this._first=null}return d(e,[{key:"setPosition",value:function(e,t){this._position=[e,t],this._first||(this._first=[e,t])}},{key:"segments",get:function(){return this.parsed.segments}},{key:"closed",get:function(){return this.parsed.closed}},{key:"linearPoints",get:function(){if(!this._linearPoints){var e,t=[],a=[],l=!0,n=!1;try{for(var i,o=this.parsed.segments[Symbol.iterator]();!(l=(i=o.next()).done);l=!0){var r=i.value,s=r.key.toLowerCase();("m"===s||"z"===s)&&(a.length&&(t.push(a),a=[]),"z"===s)||r.point&&a.push(r.point)}}catch(t){n=!0,e=t}finally{try{!l&&o.return&&o.return()}finally{if(n)throw e}}a.length&&(t.push(a),a=[]),this._linearPoints=t}return this._linearPoints}},{key:"first",get:function(){return this._first},set:function(e){this._first=e}},{key:"position",get:function(){return this._position}},{key:"x",get:function(){return this._position[0]}},{key:"y",get:function(){return this._position[1]}}]),e}(),m=function(){function e(t,a,l,o,h,d){g(this,e);var f=r/180;if(this._segIndex=0,this._numSegs=0,t[0]!=a[0]||t[1]!=a[1]){this._rx=u(l[0]),this._ry=u(l[1]),this._sinPhi=i(o*f),this._cosPhi=n(o*f);var y,c=this._cosPhi*(t[0]-a[0])/2+this._sinPhi*(t[1]-a[1])/2,_=-this._sinPhi*(t[0]-a[0])/2+this._cosPhi*(t[1]-a[1])/2,v=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*_*_-this._ry*this._ry*c*c;if(0>v){var k=p(1-v/(this._rx*this._rx*this._ry*this._ry));this._rx=k,this._ry=k,y=0}else y=(h==d?-1:1)*p(v/(this._rx*this._rx*_*_+this._ry*this._ry*c*c));var s=y*this._rx*_/this._ry,x=-y*this._ry*c/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*s-this._sinPhi*x+(t[0]+a[0])/2,this._C[1]=this._sinPhi*s+this._cosPhi*x+(t[1]+a[1])/2,this._theta=this.calculateVectorAngle(1,0,(c-s)/this._rx,(_-x)/this._ry);var m=this.calculateVectorAngle((c-s)/this._rx,(_-x)/this._ry,(-c-s)/this._rx,(-_-x)/this._ry);!d&&0<m?m-=2*r:d&&0>m&&(m+=2*r),this._numSegs=Math.ceil(u(m/(r/2))),this._delta=m/this._numSegs,this._T=8/3*i(this._delta/4)*i(this._delta/4)/i(this._delta/2),this._from=t}}return d(e,[{key:"getNextSegment",value:function(){var e,t,a;if(this._segIndex==this._numSegs)return null;var l=n(this._theta),s=i(this._theta),o=this._theta+this._delta,r=n(o),p=i(o);return a=[this._cosPhi*this._rx*r-this._sinPhi*this._ry*p+this._C[0],this._sinPhi*this._rx*r+this._cosPhi*this._ry*p+this._C[1]],e=[this._from[0]+this._T*(-this._cosPhi*this._rx*s-this._sinPhi*this._ry*l),this._from[1]+this._T*(-this._sinPhi*this._rx*s+this._cosPhi*this._ry*l)],t=[a[0]+this._T*(this._cosPhi*this._rx*p+this._sinPhi*this._ry*r),a[1]+this._T*(this._sinPhi*this._rx*p-this._cosPhi*this._ry*r)],this._theta=o,this._from=[a[0],a[1]],this._segIndex++,{cp1:e,cp2:t,to:a}}},{key:"calculateVectorAngle",value:function(e,t,a,l){var n=Math.atan2,i=n(t,e),s=n(l,a);return s>=i?s-i:2*r-(i-s)}}]),e}(),S=function(){function e(t,a){g(this,e),this.sets=t,this.closed=a}return d(e,[{key:"fit",value:function(e){var t,a=[],n=!0,s=!1;try{for(var o,r=this.sets[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){var p=o.value,h=p.length,u=l(e*h);if(5>u){if(5>=h)continue;u=5}a.push(this.reduce(p,u))}}catch(e){s=!0,t=e}finally{try{!n&&r.return&&r.return()}finally{if(s)throw t}}var g,f="",d=!0,y=!1;try{for(var c,_,v=a[Symbol.iterator]();!(d=(c=v.next()).done);d=!0){_=c.value;for(var k,x=0;x<_.length;x++)k=_[x],f+=0===x?"M"+k[0]+","+k[1]:"L"+k[0]+","+k[1];this.closed&&(f+="z ")}}catch(e){y=!0,g=e}finally{try{!d&&v.return&&v.return()}finally{if(y)throw g}}return f}},{key:"distance",value:function(e,t){return p(a(e[0]-t[0],2)+a(e[1]-t[1],2))}},{key:"reduce",value:function(e,t){if(e.length<=t)return e;for(var l=e.slice(0);l.length>t;){for(var n=-1,o=-1,r=1;r<l.length-1;r++){var i=this.distance(l[r-1],l[r]),a=this.distance(l[r],l[r+1]),h=this.distance(l[r-1],l[r+1]),u=(i+a+h)/2,s=p(u*(u-i)*(u-a)*(u-h));(0>n||s<n)&&(n=s,o=r)}if(0<o)l.splice(o,1);else break}return l}}]),e}(),b=function(){function t(){g(this,t)}var l=Math.tan;return d(t,[{key:"line",value:function(e,t,a,l,n){var i=this._doubleLine(e,t,a,l,n);return{type:"path",ops:i}}},{key:"linearPath",value:function(e,t,a){var l=(e||[]).length;if(2<l){for(var n=[],s=0;s<l-1;s++)n=n.concat(this._doubleLine(e[s][0],e[s][1],e[s+1][0],e[s+1][1],a));return t&&(n=n.concat(this._doubleLine(e[l-1][0],e[l-1][1],e[0][0],e[0][1],a))),{type:"path",ops:n}}return 2===l?this.line(e[0][0],e[0][1],e[1][0],e[1][1],a):void 0}},{key:"polygon",value:function(e,t){return this.linearPath(e,!0,t)}},{key:"rectangle",value:function(e,t,a,l,n){return this.polygon([[e,t],[e+a,t],[e+a,t+l],[e,t+l]],n)}},{key:"curve",value:function(e,t){var a=this._curveWithOffset(e,1*(1+.2*t.roughness),t),l=this._curveWithOffset(e,1.5*(1+.22*t.roughness),t);return{type:"path",ops:a.concat(l)}}},{key:"ellipse",value:function(e,t,a,l,n){var i=2*r/n.curveStepCount,s=u(a/2),o=u(l/2);s+=this._getOffset(.05*-s,.05*s,n),o+=this._getOffset(.05*-o,.05*o,n);var p=this._ellipse(i,e,t,s,o,1,i*this._getOffset(.1,this._getOffset(.4,1,n),n),n),h=this._ellipse(i,e,t,s,o,1.5,0,n);return{type:"path",ops:p.concat(h)}}},{key:"arc",value:function(e,t,a,l,s,p,d,g,f){var o=e,y=t,c=u(a/2),_=u(l/2);c+=this._getOffset(.01*-c,.01*c,f),_+=this._getOffset(.01*-_,.01*_,f);for(var v=s,k=p;0>v;)v+=2*r,k+=2*r;k-v>2*r&&(v=0,k=2*r);var x=2*r/f.curveStepCount,m=h(x/2,(k-v)/2),S=this._arc(m,o,y,c,_,v,k,1,f),b=this._arc(m,o,y,c,_,v,k,1.5,f),w=S.concat(b);return d&&(g?(w=w.concat(this._doubleLine(o,y,o+c*n(v),y+_*i(v),f)),w=w.concat(this._doubleLine(o,y,o+c*n(k),y+_*i(k),f))):(w.push({op:"lineTo",data:[o,y]}),w.push({op:"lineTo",data:[o+c*n(v),y+_*i(v)]}))),{type:"path",ops:w}}},{key:"hachureFillArc",value:function(e,t,a,l,s,p,h){var o=e,d=t,g=u(a/2),f=u(l/2);g+=this._getOffset(.01*-g,.01*g,h),f+=this._getOffset(.01*-f,.01*f,h);for(var y=s,c=p;0>y;)y+=2*r,c+=2*r;c-y>2*r&&(y=0,c=2*r);for(var _=(c-y)/h.curveStepCount,v=[],k=[],x=y;x<=c;x+=_)v.push(o+g*n(x)),k.push(d+f*i(x));return v.push(o+g*n(c)),k.push(d+f*i(c)),v.push(o),k.push(d),this.hachureFillShape(v,k,h)}},{key:"solidFillShape",value:function(e,t,a){var l=[];if(e&&t&&e.length&&t.length&&e.length===t.length){var n=a.maxRandomnessOffset||0,s=e.length;if(2<s){l.push({op:"move",data:[e[0]+this._getOffset(-n,n,a),t[0]+this._getOffset(-n,n,a)]});for(var o=1;o<s;o++)l.push({op:"lineTo",data:[e[o]+this._getOffset(-n,n,a),t[o]+this._getOffset(-n,n,a)]})}}return{type:"fillPath",ops:l}}},{key:"hachureFillShape",value:function(e,t,a){var o=[];if(e&&t&&e.length&&t.length){for(var p=e[0],u=e[0],d=t[0],g=t[0],f=1;f<e.length;f++)p=h(p,e[f]),u=s(u,e[f]),d=h(d,t[f]),g=s(g,t[f]);var y=a.hachureAngle,c=a.hachureGap;0>c&&(c=4*a.strokeWidth),c=s(c,.1);for(var v,k=y%180*(r/180),x=n(k),m=i(k),S=l(k),b=new _(d-1,g+1,p-1,u+1,c,m,x,S);null!=(v=b.getNextLine());)for(var w=this._getIntersectingLines(v,e,t),O=0;O<w.length;O++)if(O<w.length-1){var P=w[O],R=w[O+1];o=o.concat(this._doubleLine(P[0],P[1],R[0],R[1],a))}}return{type:"fillSketch",ops:o}}},{key:"hachureFillEllipse",value:function(e,t,a,n,i){var s=[],o=u(a/2),h=u(n/2);o+=this._getOffset(.05*-o,.05*o,i),h+=this._getOffset(.05*-h,.05*h,i);var d=i.hachureAngle,g=i.hachureGap;0>=g&&(g=4*i.strokeWidth);var f=i.fillWeight;0>f&&(f=i.strokeWidth/2);for(var y=l(d%180*(r/180)),c=h/o,_=p(c*y*c*y+1),v=c*y/_,k=1/_,x=g/(o*h/p(h*k*(h*k)+o*v*(o*v))/o),m=p(o*o-(e-o+x)*(e-o+x)),S=e-o+x;S<e+o;S+=x){m=p(o*o-(e-S)*(e-S));var b=this._affine(S,t-m,e,t,v,k,c),w=this._affine(S,t+m,e,t,v,k,c);s=s.concat(this._doubleLine(b[0],b[1],w[0],w[1],i))}return{type:"fillSketch",ops:s}}},{key:"svgPath",value:function(e,t){e=(e||"").replace(/\n/g," ").replace(/(-)/g," -").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var a=new x(e);if(t.simplification){var l=new S(a.linearPoints,a.closed),n=l.fit(t.simplification);a=new x(n)}for(var o=[],r=a.segments||[],p=0;p<r.length;p++){var i=r[p],s=0<p?r[p-1]:null,h=this._processSegment(a,i,s,t);h&&h.length&&(o=o.concat(h))}return{type:"path",ops:o}}},{key:"_bezierTo",value:function(e,t,a,l,n,s,r,p){for(var o=[],h=[p.maxRandomnessOffset||1,(p.maxRandomnessOffset||1)+.5],u=null,d=0;2>d;d++)0===d?o.push({op:"move",data:[r.x,r.y]}):o.push({op:"move",data:[r.x+this._getOffset(-h[0],h[0],p),r.y+this._getOffset(-h[0],h[0],p)]}),u=[n+this._getOffset(-h[d],h[d],p),s+this._getOffset(-h[d],h[d],p)],o.push({op:"bcurveTo",data:[e+this._getOffset(-h[d],h[d],p),t+this._getOffset(-h[d],h[d],p),a+this._getOffset(-h[d],h[d],p),l+this._getOffset(-h[d],h[d],p),u[0],u[1]]});return r.setPosition(u[0],u[1]),o}},{key:"_processSegment",value:function(e,t,a,l){var n=[];switch(t.key){case"M":case"m":{var s="m"===t.key;if(2<=t.data.length){var o=+t.data[0],r=+t.data[1];s&&(o+=e.x,r+=e.y);var p=1*(l.maxRandomnessOffset||0);o+=this._getOffset(-p,p,l),r+=this._getOffset(-p,p,l),e.setPosition(o,r),n.push({op:"move",data:[o,r]})}break}case"L":case"l":{var h="l"===t.key;if(2<=t.data.length){var u=+t.data[0],d=+t.data[1];h&&(u+=e.x,d+=e.y),n=n.concat(this._doubleLine(e.x,e.y,u,d,l)),e.setPosition(u,d)}break}case"H":case"h":{var g="h"===t.key;if(t.data.length){var y=+t.data[0];g&&(y+=e.x),n=n.concat(this._doubleLine(e.x,e.y,y,e.y,l)),e.setPosition(y,e.y)}break}case"V":case"v":{var c="v"===t.key;if(t.data.length){var _=+t.data[0];c&&(_+=e.y),n=n.concat(this._doubleLine(e.x,e.y,e.x,_,l)),e.setPosition(e.x,_)}break}case"Z":case"z":{e.first&&(n=n.concat(this._doubleLine(e.x,e.y,e.first[0],e.first[1],l)),e.setPosition(e.first[0],e.first[1]),e.first=null);break}case"C":case"c":{var v="c"===t.key;if(6<=t.data.length){var k=+t.data[0],x=+t.data[1],S=+t.data[2],b=+t.data[3],w=+t.data[4],O=+t.data[5];v&&(k+=e.x,S+=e.x,w+=e.x,x+=e.y,b+=e.y,O+=e.y);var P=this._bezierTo(k,x,S,b,w,O,e,l);n=n.concat(P),e.bezierReflectionPoint=[w+(w-S),O+(O-b)]}break}case"S":case"s":{var R="s"===t.key;if(4<=t.data.length){var T=+t.data[0],E=+t.data[1],A=+t.data[2],C=+t.data[3];R&&(T+=e.x,A+=e.x,E+=e.y,C+=e.y);var N=T,L=E,W=a?a.key:"",z=null;("c"==W||"C"==W||"s"==W||"S"==W)&&(z=e.bezierReflectionPoint),z&&(N=z[0],L=z[1]);var D=this._bezierTo(N,L,T,E,A,C,e,l);n=n.concat(D),e.bezierReflectionPoint=[A+(A-T),C+(C-E)]}break}case"Q":case"q":{var I="q"===t.key;if(4<=t.data.length){var F=+t.data[0],M=+t.data[1],B=+t.data[2],q=+t.data[3];I&&(F+=e.x,B+=e.x,M+=e.y,q+=e.y);var U=1*(1+.2*l.roughness),V=1.5*(1+.22*l.roughness);n.push({op:"move",data:[e.x+this._getOffset(-U,U,l),e.y+this._getOffset(-U,U,l)]});var X=[B+this._getOffset(-U,U,l),q+this._getOffset(-U,U,l)];n.push({op:"qcurveTo",data:[F+this._getOffset(-U,U,l),M+this._getOffset(-U,U,l),X[0],X[1]]}),n.push({op:"move",data:[e.x+this._getOffset(-V,V,l),e.y+this._getOffset(-V,V,l)]}),X=[B+this._getOffset(-V,V,l),q+this._getOffset(-V,V,l)],n.push({op:"qcurveTo",data:[F+this._getOffset(-V,V,l),M+this._getOffset(-V,V,l),X[0],X[1]]}),e.setPosition(X[0],X[1]),e.quadReflectionPoint=[B+(B-F),q+(q-M)]}break}case"T":case"t":{var f="t"===t.key;if(2<=t.data.length){var G=+t.data[0],j=+t.data[1];f&&(G+=e.x,j+=e.y);var H=G,$=j,Q=a?a.key:"",z=null;("q"==Q||"Q"==Q||"t"==Q||"T"==Q)&&(z=e.quadReflectionPoint),z&&(H=z[0],$=z[1]);var Z=1*(1+.2*l.roughness),Y=1.5*(1+.22*l.roughness);n.push({op:"move",data:[e.x+this._getOffset(-Z,Z,l),e.y+this._getOffset(-Z,Z,l)]});var J=[G+this._getOffset(-Z,Z,l),j+this._getOffset(-Z,Z,l)];n.push({op:"qcurveTo",data:[H+this._getOffset(-Z,Z,l),$+this._getOffset(-Z,Z,l),J[0],J[1]]}),n.push({op:"move",data:[e.x+this._getOffset(-Y,Y,l),e.y+this._getOffset(-Y,Y,l)]}),J=[G+this._getOffset(-Y,Y,l),j+this._getOffset(-Y,Y,l)],n.push({op:"qcurveTo",data:[H+this._getOffset(-Y,Y,l),$+this._getOffset(-Y,Y,l),J[0],J[1]]}),e.setPosition(J[0],J[1]),e.quadReflectionPoint=[G+(G-H),j+(j-$)]}break}case"A":case"a":{var K="a"===t.key;if(7<=t.data.length){var ee=+t.data[0],te=+t.data[1],ae=+t.data[2],le=+t.data[3],ne=+t.data[4],ie=+t.data[5],se=+t.data[6];if(K&&(ie+=e.x,se+=e.y),ie==e.x&&se==e.y)break;if(0==ee||0==te)n=n.concat(this._doubleLine(e.x,e.y,ie,se,l)),e.setPosition(ie,se);else for(var oe=l.maxRandomnessOffset||0,re=0;1>re;re++)for(var i,pe=new m([e.x,e.y],[ie,se],[ee,te],ae,!!le,!!ne),he=pe.getNextSegment();he;)i=this._bezierTo(he.cp1[0],he.cp1[1],he.cp2[0],he.cp2[1],he.to[0],he.to[1],e,l),n=n.concat(i),he=pe.getNextSegment()}break}default:}return n}},{key:"_getOffset",value:function(e,t,a){return a.roughness*(Math.random()*(t-e)+e)}},{key:"_affine",value:function(e,t,a,l,n,i,s){return[-a*i-l*n+a+i*e+n*t,s*(a*n-l*i)+l+-s*n*e+s*i*t]}},{key:"_doubleLine",value:function(e,t,a,l,n){var i=this._line(e,t,a,l,n,!0,!1),s=this._line(e,t,a,l,n,!0,!0);return i.concat(s)}},{key:"_line",value:function(e,t,l,n,i,s,o){var r=a(e-l,2)+a(t-n,2),h=i.maxRandomnessOffset||0;100*(h*h)>r&&(h=p(r)/10);var u=h/2,d=.2+.2*Math.random(),g=i.bowing*i.maxRandomnessOffset*(n-t)/200,f=i.bowing*i.maxRandomnessOffset*(e-l)/200;g=this._getOffset(-g,g,i),f=this._getOffset(-f,f,i);var y=[];return s&&(o?y.push({op:"move",data:[e+this._getOffset(-u,u,i),t+this._getOffset(-u,u,i)]}):y.push({op:"move",data:[e+this._getOffset(-h,h,i),t+this._getOffset(-h,h,i)]})),o?y.push({op:"bcurveTo",data:[g+e+(l-e)*d+this._getOffset(-u,u,i),f+t+(n-t)*d+this._getOffset(-u,u,i),g+e+2*(l-e)*d+this._getOffset(-u,u,i),f+t+2*(n-t)*d+this._getOffset(-u,u,i),l+this._getOffset(-u,u,i),n+this._getOffset(-u,u,i)]}):y.push({op:"bcurveTo",data:[g+e+(l-e)*d+this._getOffset(-h,h,i),f+t+(n-t)*d+this._getOffset(-h,h,i),g+e+2*(l-e)*d+this._getOffset(-h,h,i),f+t+2*(n-t)*d+this._getOffset(-h,h,i),l+this._getOffset(-h,h,i),n+this._getOffset(-h,h,i)]}),y}},{key:"_curve",value:function(e,t,a){var l=e.length,n=[];if(3<l){var o=[],r=1-a.curveTightness;n.push({op:"move",data:[e[1][0],e[1][1]]});for(var s,p=1;p+2<l;p++)s=e[p],o[0]=[s[0],s[1]],o[1]=[s[0]+(r*e[p+1][0]-r*e[p-1][0])/6,s[1]+(r*e[p+1][1]-r*e[p-1][1])/6],o[2]=[e[p+1][0]+(r*e[p][0]-r*e[p+2][0])/6,e[p+1][1]+(r*e[p][1]-r*e[p+2][1])/6],o[3]=[e[p+1][0],e[p+1][1]],n.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]});if(t&&2===t.length){var i=a.maxRandomnessOffset;n.push({ops:"lineTo",data:[t[0]+this._getOffset(-i,i,a),t[1]+ +this._getOffset(-i,i,a)]})}}else 3===l?(n.push({op:"move",data:[e[1][0],e[1][1]]}),n.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):2===l&&(n=n.concat(this._doubleLine(e[0][0],e[0][1],e[1][0],e[1][1],a)));return n}},{key:"_ellipse",value:function(e,t,a,l,s,p,h,u){var o=this._getOffset(-.5,.5,u)-r/2,d=[];d.push([this._getOffset(-p,p,u)+t+.9*l*n(o-e),this._getOffset(-p,p,u)+a+.9*s*i(o-e)]);for(var g=o;g<2*r+o-.01;g+=e)d.push([this._getOffset(-p,p,u)+t+l*n(g),this._getOffset(-p,p,u)+a+s*i(g)]);return d.push([this._getOffset(-p,p,u)+t+l*n(o+2*r+.5*h),this._getOffset(-p,p,u)+a+s*i(o+2*r+.5*h)]),d.push([this._getOffset(-p,p,u)+t+.98*l*n(o+h),this._getOffset(-p,p,u)+a+.98*s*i(o+h)]),d.push([this._getOffset(-p,p,u)+t+.9*l*n(o+.5*h),this._getOffset(-p,p,u)+a+.9*s*i(o+.5*h)]),this._curve(d,null,u)}},{key:"_curveWithOffset",value:function(e,t,a){for(var l=[[e[0][0]+this._getOffset(-t,t,a),e[0][1]+this._getOffset(-t,t,a)],[e[0][0]+this._getOffset(-t,t,a),e[0][1]+this._getOffset(-t,t,a)]],n=1;n<e.length;n++)l.push([e[n][0]+this._getOffset(-t,t,a),e[n][1]+this._getOffset(-t,t,a)]),n===e.length-1&&l.push([e[n][0]+this._getOffset(-t,t,a),e[n][1]+this._getOffset(-t,t,a)]);return this._curve(l,null,a)}},{key:"_arc",value:function(e,t,a,l,s,r,p,h,u){var o=r+this._getOffset(-.1,.1,u),d=[];d.push([this._getOffset(-h,h,u)+t+.9*l*n(o-e),this._getOffset(-h,h,u)+a+.9*s*i(o-e)]);for(var g=o;g<=p;g+=e)d.push([this._getOffset(-h,h,u)+t+l*n(g),this._getOffset(-h,h,u)+a+s*i(g)]);return d.push([t+l*n(p),a+s*i(p)]),d.push([t+l*n(p),a+s*i(p)]),this._curve(d,null,u)}},{key:"_getIntersectingLines",value:function(t,a,l){for(var n,s=[],o=new c(t[0],t[1],t[2],t[3]),r=0;r<a.length;r++)n=new c(a[r],l[r],a[(r+1)%a.length],l[(r+1)%a.length]),o.compare(n)==e().INTERSECTS&&s.push([o.xi,o.yi]);return s}}]),t}();self._roughScript=self.document&&self.document.currentScript&&self.document.currentScript.src;var w=function(){function e(t,a){g(this,e),this.config=t||{},this.canvas=a,this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fill:null,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1},this.config.options&&(this.defaultOptions=this._options(this.config.options))}return d(e,[{key:"_options",value:function(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}},{key:"_drawable",value:function(e,t,a){return{shape:e,sets:t||[],options:a||this.defaultOptions}}},{key:"line",value:function(e,t,a,l,n){var i=this._options(n);return this._drawable("line",[this.lib.line(e,t,a,l,i)],i)}},{key:"rectangle",value:function(e,t,a,l,n){var i=this._options(n),s=[];if(i.fill){var o=[e,e+a,e+a,e],r=[t,t,t+l,t+l];"solid"===i.fillStyle?s.push(this.lib.solidFillShape(o,r,i)):s.push(this.lib.hachureFillShape(o,r,i))}return s.push(this.lib.rectangle(e,t,a,l,i)),this._drawable("rectangle",s,i)}},{key:"ellipse",value:function(e,t,a,l,n){var i=this._options(n),s=[];if(i.fill)if("solid"===i.fillStyle){var o=this.lib.ellipse(e,t,a,l,i);o.type="fillPath",s.push(o)}else s.push(this.lib.hachureFillEllipse(e,t,a,l,i));return s.push(this.lib.ellipse(e,t,a,l,i)),this._drawable("ellipse",s,i)}},{key:"circle",value:function(e,t,a,l){var n=this.ellipse(e,t,a,a,l);return n.shape="circle",n}},{key:"linearPath",value:function(e,t){var a=this._options(t);return this._drawable("linearPath",[this.lib.linearPath(e,!1,a)],a)}},{key:"polygon",value:function(e,t){var a=this._options(t),l=[];if(a.fill){var n,i=[],s=[],o=!0,r=!1;try{for(var h,u,p=e[Symbol.iterator]();!(o=(h=p.next()).done);o=!0)u=h.value,i.push(u[0]),s.push(u[1])}catch(e){r=!0,n=e}finally{try{!o&&p.return&&p.return()}finally{if(r)throw n}}"solid"===a.fillStyle?l.push(this.lib.solidFillShape(i,s,a)):l.push(this.lib.hachureFillShape(i,s,a))}return l.push(this.lib.linearPath(e,!0,a)),this._drawable("polygon",l,a)}},{key:"arc",value:function(e,t,a,l,n,i,s,r){var p=this._options(r),o=[];if(s&&p.fill)if("solid"===p.fillStyle){var h=this.lib.arc(e,t,a,l,n,i,!0,!1,p);h.type="fillPath",o.push(h)}else o.push(this.lib.hachureFillArc(e,t,a,l,n,i,p));return o.push(this.lib.arc(e,t,a,l,n,i,s,!0,p)),this._drawable("arc",o,p)}},{key:"curve",value:function(e,t){var a=this._options(t);return this._drawable("curve",[this.lib.curve(e,a)],a)}},{key:"path",value:function(e,t){var a=this._options(t),l=[];if(!e)return this._drawable("path",l,a);if(a.fill)if("solid"===a.fillStyle){l.push({type:"path2Dfill",path:e})}else{var n=this._computePathSize(e),i=[0,n[0],n[0],0],s=[0,0,n[1],n[1]],o=this.lib.hachureFillShape(i,s,a);o.type="path2Dpattern",o.size=n,o.path=e,l.push(o)}return l.push(this.lib.svgPath(e,a)),this._drawable("path",l,a)}},{key:"toPaths",value:function(e){var a,l=e.sets||[],n=e.options||this.defaultOptions,i=[],s=!0,o=!1;try{for(var r,p=l[Symbol.iterator]();!(s=(r=p.next()).done);s=!0){var h=r.value,u=null;switch(h.type){case"path":u={d:this.opsToPath(h),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:"none"};break;case"fillPath":u={d:this.opsToPath(h),stroke:"none",strokeWidth:0,fill:n.fill};break;case"fillSketch":u=this._fillSketch(h,n);break;case"path2Dfill":u={d:h.path,stroke:"none",strokeWidth:0,fill:n.fill};break;case"path2Dpattern":{var d=h.size,g={x:0,y:0,width:1,height:1,viewBox:"0 0 "+t(d[0])+" "+t(d[1]),patternUnits:"objectBoundingBox",path:this._fillSketch(h,n)};u={d:h.path,stroke:"none",strokeWidth:0,pattern:g};break}}u&&i.push(u)}}catch(e){o=!0,a=e}finally{try{!s&&p.return&&p.return()}finally{if(o)throw a}}return i}},{key:"_fillSketch",value:function(e,t){var a=t.fillWeight;return 0>a&&(a=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill,strokeWidth:a,fill:"none"}}},{key:"opsToPath",value:function(e){var t,a="",l=!0,n=!1;try{for(var i,s=e.ops[Symbol.iterator]();!(l=(i=s.next()).done);l=!0){var o=i.value,r=o.data;switch(o.op){case"move":a+="M"+r[0]+" "+r[1]+" ";break;case"bcurveTo":a+="C"+r[0]+" "+r[1]+", "+r[2]+" "+r[3]+", "+r[4]+" "+r[5]+" ";break;case"qcurveTo":a+="Q"+r[0]+" "+r[1]+", "+r[2]+" "+r[3]+" ";break;case"lineTo":a+="L"+r[0]+" "+r[1]+" ";}}}catch(e){n=!0,t=e}finally{try{!l&&s.return&&s.return()}finally{if(n)throw t}}return a.trim()}},{key:"_computePathSize",value:function(e){var t=[0,0];if(self.document)try{var a="http://www.w3.org/2000/svg",l=self.document.createElementNS(a,"svg");l.setAttribute("width","0"),l.setAttribute("height","0");var n=self.document.createElementNS(a,"path");n.setAttribute("d",e),l.appendChild(n),self.document.body.appendChild(l);var i=n.getBBox();i&&(t[0]=i.width||0,t[1]=i.height||0),self.document.body.removeChild(l)}catch(e){}var s=this._canvasSize();return t[0]*t[1]||(t=s),t[0]=h(t[0],s[0]),t[1]=h(t[1],s[1]),t}},{key:"_canvasSize",value:function(){var e=function(e){return e&&"object"===("undefined"==typeof e?"undefined":o(e))&&e.baseVal&&e.baseVal.value?e.baseVal.value:e||100};return this.canvas?[e(this.canvas.width),e(this.canvas.height)]:[100,100]}},{key:"lib",get:function(){if(!this._renderer)if(self&&self.workly&&this.config.async&&!this.config.noWorker){var e=Function.prototype.toString,t=this.config.worklyURL||"https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js",a=this.config.roughURL||self._roughScript;if(a&&t){var l=URL.createObjectURL(new Blob(["importScripts('"+t+"', '"+a+"');\nworkly.expose(self.rough.createRenderer());"]));this._renderer=workly.proxy(l)}else this._renderer=new b}else this._renderer=new b;return this._renderer}}]),e}(),O=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,e),d(t,[{key:"line",value:async function(e,t,a,l,n){var i=this._options(n);return this._drawable("line",[await this.lib.line(e,t,a,l,i)],i)}},{key:"rectangle",value:async function(e,t,a,l,n){var i=this._options(n),s=[];if(i.fill){var o=[e,e+a,e+a,e],r=[t,t,t+l,t+l];"solid"===i.fillStyle?s.push((await this.lib.solidFillShape(o,r,i))):s.push((await this.lib.hachureFillShape(o,r,i)))}return s.push((await this.lib.rectangle(e,t,a,l,i))),this._drawable("rectangle",s,i)}},{key:"ellipse",value:async function(e,t,a,l,n){var i=this._options(n),s=[];if(i.fill)if("solid"===i.fillStyle){var o=await this.lib.ellipse(e,t,a,l,i);o.type="fillPath",s.push(o)}else s.push((await this.lib.hachureFillEllipse(e,t,a,l,i)));return s.push((await this.lib.ellipse(e,t,a,l,i))),this._drawable("ellipse",s,i)}},{key:"circle",value:async function(e,t,a,l){var n=await this.ellipse(e,t,a,a,l);return n.shape="circle",n}},{key:"linearPath",value:async function(e,t){var a=this._options(t);return this._drawable("linearPath",[await this.lib.linearPath(e,!1,a)],a)}},{key:"polygon",value:async function(e,t){var a=this._options(t),l=[];if(a.fill){var n,i=[],s=[],o=!0,r=!1;try{for(var h,u,p=e[Symbol.iterator]();!(o=(h=p.next()).done);o=!0)u=h.value,i.push(u[0]),s.push(u[1])}catch(e){r=!0,n=e}finally{try{!o&&p.return&&p.return()}finally{if(r)throw n}}"solid"===a.fillStyle?l.push((await this.lib.solidFillShape(i,s,a))):l.push((await this.lib.hachureFillShape(i,s,a)))}return l.push((await this.lib.linearPath(e,!0,a))),this._drawable("polygon",l,a)}},{key:"arc",value:async function(e,t,a,l,n,i,s,r){var p=this._options(r),o=[];if(s&&p.fill)if("solid"===p.fillStyle){var h=await this.lib.arc(e,t,a,l,n,i,!0,!1,p);h.type="fillPath",o.push(h)}else o.push((await this.lib.hachureFillArc(e,t,a,l,n,i,p)));return o.push((await this.lib.arc(e,t,a,l,n,i,s,!0,p))),this._drawable("arc",o,p)}},{key:"curve",value:async function(e,t){var a=this._options(t);return this._drawable("curve",[await this.lib.curve(e,a)],a)}},{key:"path",value:async function(e,t){var a=this._options(t),l=[];if(!e)return this._drawable("path",l,a);if(a.fill)if("solid"===a.fillStyle){l.push({type:"path2Dfill",path:e})}else{var n=this._computePathSize(e),i=[0,n[0],n[0],0],s=[0,0,n[1],n[1]],o=await this.lib.hachureFillShape(i,s,a);o.type="path2Dpattern",o.size=n,o.path=e,l.push(o)}return l.push((await this.lib.svgPath(e,a))),this._drawable("path",l,a)}}]),t}(w),P=function(){function e(t,a){g(this,e),this.canvas=t,this.ctx=this.canvas.getContext("2d"),this._init(a)}return d(e,[{key:"_init",value:function(e){this.gen=new w(e,this.canvas)}},{key:"line",value:function(e,t,a,l,n){var i=this.gen.line(e,t,a,l,n);return this.draw(i),i}},{key:"rectangle",value:function(e,t,a,l,n){var i=this.gen.rectangle(e,t,a,l,n);return this.draw(i),i}},{key:"ellipse",value:function(e,t,a,l,n){var i=this.gen.ellipse(e,t,a,l,n);return this.draw(i),i}},{key:"circle",value:function(e,t,a,l){var n=this.gen.circle(e,t,a,l);return this.draw(n),n}},{key:"linearPath",value:function(e,t){var a=this.gen.linearPath(e,t);return this.draw(a),a}},{key:"polygon",value:function(e,t){var a=this.gen.polygon(e,t);return this.draw(a),a}},{key:"arc",value:function(e,t,a,l,n,i,s,o){var r=this.gen.arc(e,t,a,l,n,i,s,o);return this.draw(r),r}},{key:"curve",value:function(e,t){var a=this.gen.curve(e,t);return this.draw(a),a}},{key:"path",value:function(e,t){var a=this.gen.path(e,t);return this.draw(a),a}},{key:"draw",value:function(e){var t,a=e.sets||[],l=e.options||this.gen.defaultOptions,n=this.ctx,i=!0,s=!1;try{for(var o,r,p=a[Symbol.iterator]();!(i=(o=p.next()).done);i=!0)switch(r=o.value,r.type){case"path":n.save(),n.strokeStyle=l.stroke,n.lineWidth=l.strokeWidth,this._drawToContext(n,r),n.restore();break;case"fillPath":n.save(),n.fillStyle=l.fill,this._drawToContext(n,r,l),n.restore();break;case"fillSketch":this._fillSketch(n,r,l);break;case"path2Dfill":{this.ctx.save(),this.ctx.fillStyle=l.fill;var h=new Path2D(r.path);this.ctx.fill(h),this.ctx.restore();break}case"path2Dpattern":{var u=r.size,d=document.createElement("canvas"),g=d.getContext("2d"),f=this._computeBBox(r.path);f&&(f.width||f.height)?(d.width=this.canvas.width,d.height=this.canvas.height,g.translate(f.x||0,f.y||0)):(d.width=u[0],d.height=u[1]),this._fillSketch(g,r,l),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(d,"repeat");var y=new Path2D(r.path);this.ctx.fill(y),this.ctx.restore();break}}}catch(e){s=!0,t=e}finally{try{!i&&p.return&&p.return()}finally{if(s)throw t}}}},{key:"_computeBBox",value:function(e){if(self.document)try{var t="http://www.w3.org/2000/svg",a=self.document.createElementNS(t,"svg");a.setAttribute("width","0"),a.setAttribute("height","0");var l=self.document.createElementNS(t,"path");l.setAttribute("d",e),a.appendChild(l),self.document.body.appendChild(a);var n=l.getBBox();return self.document.body.removeChild(a),n}catch(e){}return null}},{key:"_fillSketch",value:function(e,t,a){var l=a.fillWeight;0>l&&(l=a.strokeWidth/2),e.save(),e.strokeStyle=a.fill,e.lineWidth=l,this._drawToContext(e,t),e.restore()}},{key:"_drawToContext",value:function(e,t){e.beginPath();var a,l=!0,n=!1;try{for(var i,s=t.ops[Symbol.iterator]();!(l=(i=s.next()).done);l=!0){var o=i.value,r=o.data;switch(o.op){case"move":e.moveTo(r[0],r[1]);break;case"bcurveTo":e.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"qcurveTo":e.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case"lineTo":e.lineTo(r[0],r[1]);}}}catch(e){n=!0,a=e}finally{try{!l&&s.return&&s.return()}finally{if(n)throw a}}"fillPath"===t.type?e.fill():e.stroke()}},{key:"generator",get:function(){return this.gen}}],[{key:"createRenderer",value:function(){return new b}}]),e}(),R=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,e),d(t,[{key:"_init",value:function(e){this.gen=new O(e,this.canvas)}},{key:"line",value:async function(e,t,a,l,n){var i=await this.gen.line(e,t,a,l,n);return this.draw(i),i}},{key:"rectangle",value:async function(e,t,a,l,n){var i=await this.gen.rectangle(e,t,a,l,n);return this.draw(i),i}},{key:"ellipse",value:async function(e,t,a,l,n){var i=await this.gen.ellipse(e,t,a,l,n);return this.draw(i),i}},{key:"circle",value:async function(e,t,a,l){var n=await this.gen.circle(e,t,a,l);return this.draw(n),n}},{key:"linearPath",value:async function(e,t){var a=await this.gen.linearPath(e,t);return this.draw(a),a}},{key:"polygon",value:async function(e,t){var a=await this.gen.polygon(e,t);return this.draw(a),a}},{key:"arc",value:async function(e,t,a,l,n,i,s,o){var r=await this.gen.arc(e,t,a,l,n,i,s,o);return this.draw(r),r}},{key:"curve",value:async function(e,t){var a=await this.gen.curve(e,t);return this.draw(a),a}},{key:"path",value:async function(e,t){var a=await this.gen.path(e,t);return this.draw(a),a}}]),t}(P),T=function(){function e(t,a){g(this,e),this.svg=t,this._init(a)}return d(e,[{key:"_init",value:function(e){this.gen=new w(e,this.svg)}},{key:"line",value:function(e,t,a,l,n){var i=this.gen.line(e,t,a,l,n);return this.draw(i)}},{key:"rectangle",value:function(e,t,a,l,n){var i=this.gen.rectangle(e,t,a,l,n);return this.draw(i)}},{key:"ellipse",value:function(e,t,a,l,n){var i=this.gen.ellipse(e,t,a,l,n);return this.draw(i)}},{key:"circle",value:function(e,t,a,l){var n=this.gen.circle(e,t,a,l);return this.draw(n)}},{key:"linearPath",value:function(e,t){var a=this.gen.linearPath(e,t);return this.draw(a)}},{key:"polygon",value:function(e,t){var a=this.gen.polygon(e,t);return this.draw(a)}},{key:"arc",value:function(e,t,a,l,n,i,s,o){var r=this.gen.arc(e,t,a,l,n,i,s,o);return this.draw(r)}},{key:"curve",value:function(e,t){var a=this.gen.curve(e,t);return this.draw(a)}},{key:"path",value:function(e,t){var a=this.gen.path(e,t);return this.draw(a)}},{key:"draw",value:function(e){var a,n=e.sets||[],i=e.options||this.gen.defaultOptions,s=this.svg.ownerDocument||document,o=s.createElementNS("http://www.w3.org/2000/svg","g"),r=!0,p=!1;try{for(var h,u=n[Symbol.iterator]();!(r=(h=u.next()).done);r=!0){var d=h.value,g=null;switch(d.type){case"path":{g=s.createElementNS("http://www.w3.org/2000/svg","path"),g.setAttribute("d",this._opsToPath(d)),g.style.stroke=i.stroke,g.style.strokeWidth=i.strokeWidth,g.style.fill="none";break}case"fillPath":{g=s.createElementNS("http://www.w3.org/2000/svg","path"),g.setAttribute("d",this._opsToPath(d)),g.style.stroke="none",g.style.strokeWidth=0,g.style.fill=i.fill;break}case"fillSketch":{g=this._fillSketch(s,d,i);break}case"path2Dfill":{g=s.createElementNS("http://www.w3.org/2000/svg","path"),g.setAttribute("d",d.path),g.style.stroke="none",g.style.strokeWidth=0,g.style.fill=i.fill;break}case"path2Dpattern":{var f=d.size,y=s.createElementNS("http://www.w3.org/2000/svg","pattern"),c="rough-"+l(Math.random()*(Number.MAX_SAFE_INTEGER||999999));y.setAttribute("id",c),y.setAttribute("x",0),y.setAttribute("y",0),y.setAttribute("width",1),y.setAttribute("height",1),y.setAttribute("height",1),y.setAttribute("viewBox","0 0 "+t(f[0])+" "+t(f[1])),y.setAttribute("patternUnits","objectBoundingBox");var _=this._fillSketch(s,d,i);y.appendChild(_),this.defs.appendChild(y),g=s.createElementNS("http://www.w3.org/2000/svg","path"),g.setAttribute("d",d.path),g.style.stroke="none",g.style.strokeWidth=0,g.style.fill="url(#"+c+")";break}}g&&o.appendChild(g)}}catch(e){p=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(p)throw a}}return o}},{key:"_fillSketch",value:function(e,t,a){var l=a.fillWeight;0>l&&(l=a.strokeWidth/2);var n=e.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",this._opsToPath(t)),n.style.stroke=a.fill,n.style.strokeWidth=l,n.style.fill="none",n}},{key:"_opsToPath",value:function(e){return this.gen.opsToPath(e)}},{key:"generator",get:function(){return this.gen}},{key:"defs",get:function(){if(!this._defs){var e=this.svg.ownerDocument||document,t=e.createElementNS("http://www.w3.org/2000/svg","defs");this.svg.firstChild?this.svg.insertBefore(t,this.svg.firstChild):this.svg.appendChild(t),this._defs=t}return this._defs}}]),e}(),E=function(e){function t(){return g(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,e),d(t,[{key:"_init",value:function(e){this.gen=new O(e,this.svg)}},{key:"line",value:async function(e,t,a,l,n){var i=await this.gen.line(e,t,a,l,n);return this.draw(i)}},{key:"rectangle",value:async function(e,t,a,l,n){var i=await this.gen.rectangle(e,t,a,l,n);return this.draw(i)}},{key:"ellipse",value:async function(e,t,a,l,n){var i=await this.gen.ellipse(e,t,a,l,n);return this.draw(i)}},{key:"circle",value:async function(e,t,a,l){var n=await this.gen.circle(e,t,a,l);return this.draw(n)}},{key:"linearPath",value:async function(e,t){var a=await this.gen.linearPath(e,t);return this.draw(a)}},{key:"polygon",value:async function(e,t){var a=await this.gen.polygon(e,t);return this.draw(a)}},{key:"arc",value:async function(e,t,a,l,n,i,s,o){var r=await this.gen.arc(e,t,a,l,n,i,s,o);return this.draw(r)}},{key:"curve",value:async function(e,t){var a=await this.gen.curve(e,t);return this.draw(a)}},{key:"path",value:async function(e,t){var a=await this.gen.path(e,t);return this.draw(a)}}]),t}(T);return{canvas:function(e,t){return t&&t.async?new R(e,t):new P(e,t)},svg:function(e,t){return t&&t.async?new E(e,t):new T(e,t)},createRenderer:function(){return P.createRenderer()},generator:function(e,t){return e&&e.async?new O(e,t):new w(e,t)}}}();