'use strict';function _interopDefault(e){return e&&'object'==typeof e&&'default'in e?e['default']:e}var _classCallCheck=_interopDefault(require('babel-runtime/helpers/classCallCheck')),_createClass=_interopDefault(require('babel-runtime/helpers/createClass')),_getIterator=_interopDefault(require('babel-runtime/core-js/get-iterator')),_regeneratorRuntime=_interopDefault(require('babel-runtime/regenerator')),_asyncToGenerator=_interopDefault(require('babel-runtime/helpers/asyncToGenerator')),_Object$getPrototypeOf=_interopDefault(require('babel-runtime/core-js/object/get-prototype-of')),_possibleConstructorReturn=_interopDefault(require('babel-runtime/helpers/possibleConstructorReturn')),_inherits=_interopDefault(require('babel-runtime/helpers/inherits')),_typeof=_interopDefault(require('babel-runtime/helpers/typeof')),_Object$assign=_interopDefault(require('babel-runtime/core-js/object/assign')),_Number$MAX_SAFE_INTEGER=_interopDefault(require('babel-runtime/core-js/number/max-safe-integer'));function RoughSegmentRelation(){return{LEFT:0,RIGHT:1,INTERSECTS:2,AHEAD:3,BEHIND:4,SEPARATE:5,UNDEFINED:6}}var RoughSegment=function(){function e(t,a,n,l){_classCallCheck(this,e),this.RoughSegmentRelationConst=RoughSegmentRelation(),this.px1=t,this.py1=a,this.px2=n,this.py2=l,this.xi=s,this.yi=s,this.a=l-a,this.b=t-n,this.c=n*a-t*l,this._undefined=0==this.a&&0==this.b&&0==this.c}var t=Math.max,n=Math.min,l=Math.abs,s=Number.MAX_VALUE;return _createClass(e,[{key:'isUndefined',value:function(){return this._undefined}},{key:'compare',value:function(e){if(this.isUndefined()||e.isUndefined())return this.RoughSegmentRelationConst.UNDEFINED;var r=s,i=s,o=0,p=0,u=this.a,h=this.b,d=this.c;return(1e-5<l(h)&&(r=-u/h,o=-d/h),1e-5<l(e.b)&&(i=-e.a/e.b,p=-e.c/e.b),r==s)?i==s?-d/u==-e.c/e.a?this.py1>=n(e.py1,e.py2)&&this.py1<=t(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.py2>=n(e.py1,e.py2)&&this.py2<=t(e.py1,e.py2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=this.px1,this.yi=i*this.xi+p,-1e-5>(this.py1-this.yi)*(this.yi-this.py2)||-1e-5>(e.py1-this.yi)*(this.yi-e.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>l(e.a)?-1e-5>(e.px1-this.xi)*(this.xi-e.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS:this.RoughSegmentRelationConst.INTERSECTS):i==s?(this.xi=e.px1,this.yi=r*this.xi+o,-1e-5>(e.py1-this.yi)*(this.yi-e.py2)||-1e-5>(this.py1-this.yi)*(this.yi-this.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>l(u)?-1e-5>(this.px1-this.xi)*(this.xi-this.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS:this.RoughSegmentRelationConst.INTERSECTS):r==i?o==p?this.px1>=n(e.px1,e.px2)&&this.px1<=t(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.px2>=n(e.px1,e.px2)&&this.px2<=t(e.px1,e.px2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=(p-o)/(r-i),this.yi=r*this.xi+o,-1e-5>(this.px1-this.xi)*(this.xi-this.px2)||-1e-5>(e.px1-this.xi)*(this.xi-e.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS)}},{key:'getLength',value:function(){return this._getLength(this.px1,this.py1,this.px2,this.py2)}},{key:'_getLength',value:function(e,t,a,n){var l=a-e,s=n-t;return Math.sqrt(l*l+s*s)}}]),e}(),RoughHachureIterator=function(){function e(a,n,l,s,r,i,o,p){_classCallCheck(this,e),this.top=a,this.bottom=n,this.left=l,this.right=s,this.gap=r,this.sinAngle=i,this.tanAngle=p,1e-4>t(i)?this.pos=l+r:.9999<t(i)?this.pos=a+r:(this.deltaX=(n-a)*t(p),this.pos=l-t(this.deltaX),this.hGap=t(r/o),this.sLeft=new RoughSegment(l,n,l,a),this.sRight=new RoughSegment(s,n,s,a))}var t=Math.abs;return _createClass(e,[{key:'getNextLine',value:function(){if(1e-4>t(this.sinAngle)){if(this.pos<this.right){var e=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,e}}else if(!(.9999<t(this.sinAngle))){var a=this.pos-this.deltaX/2,n=this.pos+this.deltaX/2,l=this.bottom,r=this.top;if(this.pos<this.right+this.deltaX){for(;a<this.left&&n<this.left||a>this.right&&n>this.right;)if(this.pos+=this.hGap,a=this.pos-this.deltaX/2,n=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;var i=new RoughSegment(a,l,n,r);i.compare(this.sLeft)==RoughSegmentRelation().INTERSECTS&&(a=i.xi,l=i.yi),i.compare(this.sRight)==RoughSegmentRelation().INTERSECTS&&(n=i.xi,r=i.yi),0<this.tanAngle&&(a=this.right-(a-this.left),n=this.right-(n-this.left));var s=[a,l,n,r];return this.pos+=this.hGap,s}}else if(this.pos<this.bottom){var o=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,o}return null}}]),e}(),PathToken=function(){function e(t,a){_classCallCheck(this,e),this.type=t,this.text=a}return _createClass(e,[{key:'isType',value:function(e){return this.type===e}}]),e}(),ParsedPath=function(){function e(t){_classCallCheck(this,e),this.PARAMS={A:['rx','ry','x-axis-rotation','large-arc-flag','sweep-flag','x','y'],a:['rx','ry','x-axis-rotation','large-arc-flag','sweep-flag','x','y'],C:['x1','y1','x2','y2','x','y'],c:['x1','y1','x2','y2','x','y'],H:['x'],h:['x'],L:['x','y'],l:['x','y'],M:['x','y'],m:['x','y'],Q:['x1','y1','x','y'],q:['x1','y1','x','y'],S:['x2','y2','x','y'],s:['x2','y2','x','y'],T:['x','y'],t:['x','y'],V:['y'],v:['y'],Z:[],z:[]},this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.d=t||'',this.parseData(t),this.processPoints()}return _createClass(e,[{key:'loadFromSegments',value:function(e){this.segments=e,this.processPoints()}},{key:'processPoints',value:function(){for(var e,t=null,a=[0,0],n=0;n<this.segments.length;n++){switch(e=this.segments[n],e.key){case'M':case'L':case'T':e.point=[e.data[0],e.data[1]];break;case'm':case'l':case't':e.point=[e.data[0]+a[0],e.data[1]+a[1]];break;case'H':e.point=[e.data[0],a[1]];break;case'h':e.point=[e.data[0]+a[0],a[1]];break;case'V':e.point=[a[0],e.data[0]];break;case'v':e.point=[a[0],e.data[0]+a[1]];break;case'z':case'Z':t&&(e.point=[t[0],t[1]]);break;case'C':e.point=[e.data[4],e.data[5]];break;case'c':e.point=[e.data[4]+a[0],e.data[5]+a[1]];break;case'S':e.point=[e.data[2],e.data[3]];break;case's':e.point=[e.data[2]+a[0],e.data[3]+a[1]];break;case'Q':e.point=[e.data[2],e.data[3]];break;case'q':e.point=[e.data[2]+a[0],e.data[3]+a[1]];break;case'A':e.point=[e.data[5],e.data[6]];break;case'a':e.point=[e.data[5]+a[0],e.data[6]+a[1]];}('m'===e.key||'M'===e.key)&&(t=null),e.point&&(a=e.point,!t&&(t=e.point)),('z'===e.key||'Z'===e.key)&&(t=null)}}},{key:'parseData',value:function(e){var t=this.tokenize(e),a=0,n=t[a],l='BOD';for(this.segments=[];!n.isType(this.EOD);){var s,r=[];if('BOD'!=l)n.isType(this.NUMBER)?s=this.PARAMS[l].length:(a++,s=this.PARAMS[n.text].length,l=n.text);else if('M'==n.text||'m'==n.text)a++,s=this.PARAMS[n.text].length,l=n.text;else return this.parseData('M0,0'+e);if(a+s<t.length){for(var o,p=a;p<a+s;p++)if(o=t[p],o.isType(this.NUMBER))r[r.length]=o.text;else return void console.error('Parameter type is not a number: '+l+','+o.text);var i;if(this.PARAMS[l])i={key:l,data:r};else return void console.error('Unsupported segment type: '+l);this.segments.push(i),a+=s,n=t[a],'M'==l&&(l='L'),'m'==l&&(l='l')}else console.error('Path data ended before all parameters were found')}}},{key:'tokenize',value:function(e){for(var t=[];''!=e;)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]=new PathToken(this.COMMAND,RegExp.$1),e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]=new PathToken(this.NUMBER,parseFloat(RegExp.$1)),e=e.substr(RegExp.$1.length);else return console.error('Unrecognized segment command: '+e),null;return t[t.length]=new PathToken(this.EOD,null),t}},{key:'closed',get:function(){if('undefined'==typeof this._closed){this._closed=!1;var e,t=!0,a=!1;try{for(var n,l,s=_getIterator(this.segments);!(t=(n=s.next()).done);t=!0)l=n.value,'z'===l.key.toLowerCase()&&(this._closed=!0)}catch(t){a=!0,e=t}finally{try{!t&&s.return&&s.return()}finally{if(a)throw e}}}return this._closed}}]),e}(),RoughPath=function(){function e(t){_classCallCheck(this,e),this.d=t,this.parsed=new ParsedPath(t),this._position=[0,0],this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this._first=null}return _createClass(e,[{key:'setPosition',value:function(e,t){this._position=[e,t],this._first||(this._first=[e,t])}},{key:'segments',get:function(){return this.parsed.segments}},{key:'closed',get:function(){return this.parsed.closed}},{key:'linearPoints',get:function(){if(!this._linearPoints){var e,t=[],a=[],n=!0,l=!1;try{for(var r,i=_getIterator(this.parsed.segments);!(n=(r=i.next()).done);n=!0){var o=r.value,s=o.key.toLowerCase();('m'===s||'z'===s)&&(a.length&&(t.push(a),a=[]),'z'===s)||o.point&&a.push(o.point)}}catch(t){l=!0,e=t}finally{try{!n&&i.return&&i.return()}finally{if(l)throw e}}a.length&&(t.push(a),a=[]),this._linearPoints=t}return this._linearPoints}},{key:'first',get:function(){return this._first},set:function(e){this._first=e}},{key:'position',get:function(){return this._position}},{key:'x',get:function(){return this._position[0]}},{key:'y',get:function(){return this._position[1]}}]),e}(),RoughArcConverter=function(){function e(i,o,p,u,h,d){_classCallCheck(this,e);var g=n/180;if(this._segIndex=0,this._numSegs=0,i[0]!=o[0]||i[1]!=o[1]){this._rx=r(p[0]),this._ry=r(p[1]),this._sinPhi=a(u*g),this._cosPhi=t(u*g);var f,y=this._cosPhi*(i[0]-o[0])/2+this._sinPhi*(i[1]-o[1])/2,c=-this._sinPhi*(i[0]-o[0])/2+this._cosPhi*(i[1]-o[1])/2,_=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*c*c-this._ry*this._ry*y*y;if(0>_){var x=l(1-_/(this._rx*this._rx*this._ry*this._ry));this._rx=x,this._ry=x,f=0}else f=(h==d?-1:1)*l(_/(this._rx*this._rx*c*c+this._ry*this._ry*y*y));var s=f*this._rx*c/this._ry,v=-f*this._ry*y/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*s-this._sinPhi*v+(i[0]+o[0])/2,this._C[1]=this._sinPhi*s+this._cosPhi*v+(i[1]+o[1])/2,this._theta=this.calculateVectorAngle(1,0,(y-s)/this._rx,(c-v)/this._ry);var k=this.calculateVectorAngle((y-s)/this._rx,(c-v)/this._ry,(-y-s)/this._rx,(-c-v)/this._ry);!d&&0<k?k-=2*n:d&&0>k&&(k+=2*n),this._numSegs=Math.ceil(r(k/(n/2))),this._delta=k/this._numSegs,this._T=8/3*a(this._delta/4)*a(this._delta/4)/a(this._delta/2),this._from=i}}var t=Math.cos,a=Math.sin,n=Math.PI,l=Math.sqrt,r=Math.abs;return _createClass(e,[{key:'getNextSegment',value:function(){var e,n,l;if(this._segIndex==this._numSegs)return null;var s=t(this._theta),r=a(this._theta),i=this._theta+this._delta,o=t(i),p=a(i);return l=[this._cosPhi*this._rx*o-this._sinPhi*this._ry*p+this._C[0],this._sinPhi*this._rx*o+this._cosPhi*this._ry*p+this._C[1]],e=[this._from[0]+this._T*(-this._cosPhi*this._rx*r-this._sinPhi*this._ry*s),this._from[1]+this._T*(-this._sinPhi*this._rx*r+this._cosPhi*this._ry*s)],n=[l[0]+this._T*(this._cosPhi*this._rx*p+this._sinPhi*this._ry*o),l[1]+this._T*(this._sinPhi*this._rx*p-this._cosPhi*this._ry*o)],this._theta=i,this._from=[l[0],l[1]],this._segIndex++,{cp1:e,cp2:n,to:l}}},{key:'calculateVectorAngle',value:function(e,t,a,l){var s=Math.atan2,r=s(t,e),i=s(l,a);return i>=r?i-r:2*n-(r-i)}}]),e}(),PathFitter=function(){function e(t,a){_classCallCheck(this,e),this.sets=t,this.closed=a}var t=Math.pow,n=Math.sqrt;return _createClass(e,[{key:'fit',value:function(e){var t,a=[],n=!0,l=!1;try{for(var s,r=_getIterator(this.sets);!(n=(s=r.next()).done);n=!0){var o=s.value,p=o.length,u=Math.floor(e*p);if(5>u){if(5>=p)continue;u=5}a.push(this.reduce(o,u))}}catch(e){l=!0,t=e}finally{try{!n&&r.return&&r.return()}finally{if(l)throw t}}var h,g='',d=!0,f=!1;try{for(var y,c,_=_getIterator(a);!(d=(y=_.next()).done);d=!0){c=y.value;for(var x,v=0;v<c.length;v++)x=c[v],g+=0===v?'M'+x[0]+','+x[1]:'L'+x[0]+','+x[1];this.closed&&(g+='z ')}}catch(e){f=!0,h=e}finally{try{!d&&_.return&&_.return()}finally{if(f)throw h}}return g}},{key:'distance',value:function(e,a){return n(t(e[0]-a[0],2)+t(e[1]-a[1],2))}},{key:'reduce',value:function(e,t){if(e.length<=t)return e;for(var l=e.slice(0);l.length>t;){for(var r=-1,o=-1,p=1;p<l.length-1;p++){var i=this.distance(l[p-1],l[p]),a=this.distance(l[p],l[p+1]),u=this.distance(l[p-1],l[p+1]),h=(i+a+u)/2,s=n(h*(h-i)*(h-a)*(h-u));(0>r||s<r)&&(r=s,o=p)}if(0<o)l.splice(o,1);else break}return l}}]),e}(),RoughRenderer=function(){function e(){_classCallCheck(this,e)}var t=Math.tan,a=Math.pow,n=Math.cos,l=Math.sin,s=Math.PI,r=Math.sqrt,p=Math.max,u=Math.min,i=Math.abs;return _createClass(e,[{key:'line',value:function(e,t,a,n,l){var s=this._doubleLine(e,t,a,n,l);return{type:'path',ops:s}}},{key:'linearPath',value:function(e,t,a){var n=(e||[]).length;if(2<n){for(var l=[],s=0;s<n-1;s++)l=l.concat(this._doubleLine(e[s][0],e[s][1],e[s+1][0],e[s+1][1],a));return t&&(l=l.concat(this._doubleLine(e[n-1][0],e[n-1][1],e[0][0],e[0][1],a))),{type:'path',ops:l}}return 2===n?this.line(e[0][0],e[0][1],e[1][0],e[1][1],a):void 0}},{key:'polygon',value:function(e,t){return this.linearPath(e,!0,t)}},{key:'rectangle',value:function(e,t,a,n,l){return this.polygon([[e,t],[e+a,t],[e+a,t+n],[e,t+n]],l)}},{key:'curve',value:function(e,t){var a=this._curveWithOffset(e,1*(1+.2*t.roughness),t),n=this._curveWithOffset(e,1.5*(1+.22*t.roughness),t);return{type:'path',ops:a.concat(n)}}},{key:'ellipse',value:function(e,t,a,n,l){var r=2*s/l.curveStepCount,o=i(a/2),p=i(n/2);o+=this._getOffset(.05*-o,.05*o,l),p+=this._getOffset(.05*-p,.05*p,l);var u=this._ellipse(r,e,t,o,p,1,r*this._getOffset(.1,this._getOffset(.4,1,l),l),l),h=this._ellipse(r,e,t,o,p,1.5,0,l);return{type:'path',ops:u.concat(h)}}},{key:'arc',value:function(e,t,a,r,p,h,d,g,f){var o=e,y=t,c=i(a/2),_=i(r/2);c+=this._getOffset(.01*-c,.01*c,f),_+=this._getOffset(.01*-_,.01*_,f);for(var x=p,v=h;0>x;)x+=2*s,v+=2*s;v-x>2*s&&(x=0,v=2*s);var k=2*s/f.curveStepCount,m=u(k/2,(v-x)/2),b=this._arc(m,o,y,c,_,x,v,1,f),w=this._arc(m,o,y,c,_,x,v,1.5,f),S=b.concat(w);return d&&(g?(S=S.concat(this._doubleLine(o,y,o+c*n(x),y+_*l(x),f)),S=S.concat(this._doubleLine(o,y,o+c*n(v),y+_*l(v),f))):(S.push({op:'lineTo',data:[o,y]}),S.push({op:'lineTo',data:[o+c*n(x),y+_*l(x)]}))),{type:'path',ops:S}}},{key:'hachureFillArc',value:function(e,t,a,r,p,u,h){var o=e,d=t,g=i(a/2),f=i(r/2);g+=this._getOffset(.01*-g,.01*g,h),f+=this._getOffset(.01*-f,.01*f,h);for(var y=p,c=u;0>y;)y+=2*s,c+=2*s;c-y>2*s&&(y=0,c=2*s);for(var _=(c-y)/h.curveStepCount,x=[],v=[],k=y;k<=c;k+=_)x.push(o+g*n(k)),v.push(d+f*l(k));return x.push(o+g*n(c)),v.push(d+f*l(c)),x.push(o),v.push(d),this.hachureFillShape(x,v,h)}},{key:'solidFillShape',value:function(e,t,a){var n=[];if(e&&t&&e.length&&t.length&&e.length===t.length){var l=a.maxRandomnessOffset||0,s=e.length;if(2<s){n.push({op:'move',data:[e[0]+this._getOffset(-l,l,a),t[0]+this._getOffset(-l,l,a)]});for(var r=1;r<s;r++)n.push({op:'lineTo',data:[e[r]+this._getOffset(-l,l,a),t[r]+this._getOffset(-l,l,a)]})}}return{type:'fillPath',ops:n}}},{key:'hachureFillShape',value:function(e,a,r){var o=[];if(e&&a&&e.length&&a.length){for(var h=e[0],d=e[0],g=a[0],f=a[0],y=1;y<e.length;y++)h=u(h,e[y]),d=p(d,e[y]),g=u(g,a[y]),f=p(f,a[y]);var i=r.hachureAngle,c=r.hachureGap;0>c&&(c=4*r.strokeWidth),c=p(c,.1);for(var _,x=i%180*(s/180),v=n(x),k=l(x),m=t(x),b=new RoughHachureIterator(g-1,f+1,h-1,d+1,c,k,v,m);null!=(_=b.getNextLine());)for(var w=this._getIntersectingLines(_,e,a),S=0;S<w.length;S++)if(S<w.length-1){var O=w[S],P=w[S+1];o=o.concat(this._doubleLine(O[0],O[1],P[0],P[1],r))}}return{type:'fillSketch',ops:o}}},{key:'hachureFillEllipse',value:function(e,a,n,l,p){var o=[],u=i(n/2),h=i(l/2);u+=this._getOffset(.05*-u,.05*u,p),h+=this._getOffset(.05*-h,.05*h,p);var d=p.hachureAngle,g=p.hachureGap;0>=g&&(g=4*p.strokeWidth);var f=p.fillWeight;0>f&&(f=p.strokeWidth/2);for(var y=t(d%180*(s/180)),c=h/u,_=r(c*y*c*y+1),x=c*y/_,v=1/_,k=g/(u*h/r(h*v*(h*v)+u*x*(u*x))/u),m=r(u*u-(e-u+k)*(e-u+k)),b=e-u+k;b<e+u;b+=k){m=r(u*u-(e-b)*(e-b));var w=this._affine(b,a-m,e,a,x,v,c),S=this._affine(b,a+m,e,a,x,v,c);o=o.concat(this._doubleLine(w[0],w[1],S[0],S[1],p))}return{type:'fillSketch',ops:o}}},{key:'svgPath',value:function(e,t){e=(e||'').replace(/\n/g,' ').replace(/(-)/g,' -').replace(/(-\s)/g,'-').replace('/(ss)/g',' ');var a=new RoughPath(e);if(t.simplification){var n=new PathFitter(a.linearPoints,a.closed),l=n.fit(t.simplification);a=new RoughPath(l)}for(var r=[],o=a.segments||[],p=0;p<o.length;p++){var i=o[p],s=0<p?o[p-1]:null,u=this._processSegment(a,i,s,t);u&&u.length&&(r=r.concat(u))}return{type:'path',ops:r}}},{key:'_bezierTo',value:function(e,t,a,n,l,s,r,p){for(var o=[],u=[p.maxRandomnessOffset||1,(p.maxRandomnessOffset||1)+.5],h=null,d=0;2>d;d++)0===d?o.push({op:'move',data:[r.x,r.y]}):o.push({op:'move',data:[r.x+this._getOffset(-u[0],u[0],p),r.y+this._getOffset(-u[0],u[0],p)]}),h=[l+this._getOffset(-u[d],u[d],p),s+this._getOffset(-u[d],u[d],p)],o.push({op:'bcurveTo',data:[e+this._getOffset(-u[d],u[d],p),t+this._getOffset(-u[d],u[d],p),a+this._getOffset(-u[d],u[d],p),n+this._getOffset(-u[d],u[d],p),h[0],h[1]]});return r.setPosition(h[0],h[1]),o}},{key:'_processSegment',value:function(e,t,a,n){var l=[];switch(t.key){case'M':case'm':{var s='m'===t.key;if(2<=t.data.length){var r=+t.data[0],o=+t.data[1];s&&(r+=e.x,o+=e.y);var p=1*(n.maxRandomnessOffset||0);r+=this._getOffset(-p,p,n),o+=this._getOffset(-p,p,n),e.setPosition(r,o),l.push({op:'move',data:[r,o]})}break}case'L':case'l':{var u='l'===t.key;if(2<=t.data.length){var h=+t.data[0],d=+t.data[1];u&&(h+=e.x,d+=e.y),l=l.concat(this._doubleLine(e.x,e.y,h,d,n)),e.setPosition(h,d)}break}case'H':case'h':{var g='h'===t.key;if(t.data.length){var y=+t.data[0];g&&(y+=e.x),l=l.concat(this._doubleLine(e.x,e.y,y,e.y,n)),e.setPosition(y,e.y)}break}case'V':case'v':{var c='v'===t.key;if(t.data.length){var _=+t.data[0];c&&(_+=e.y),l=l.concat(this._doubleLine(e.x,e.y,e.x,_,n)),e.setPosition(e.x,_)}break}case'Z':case'z':{e.first&&(l=l.concat(this._doubleLine(e.x,e.y,e.first[0],e.first[1],n)),e.setPosition(e.first[0],e.first[1]),e.first=null);break}case'C':case'c':{var x='c'===t.key;if(6<=t.data.length){var v=+t.data[0],k=+t.data[1],m=+t.data[2],b=+t.data[3],w=+t.data[4],S=+t.data[5];x&&(v+=e.x,m+=e.x,w+=e.x,k+=e.y,b+=e.y,S+=e.y);var O=this._bezierTo(v,k,m,b,w,S,e,n);l=l.concat(O),e.bezierReflectionPoint=[w+(w-m),S+(S-b)]}break}case'S':case's':{var P='s'===t.key;if(4<=t.data.length){var R=+t.data[0],T=+t.data[1],E=+t.data[2],C=+t.data[3];P&&(R+=e.x,E+=e.x,T+=e.y,C+=e.y);var A=R,N=T,L=a?a.key:'',W=null;('c'==L||'C'==L||'s'==L||'S'==L)&&(W=e.bezierReflectionPoint),W&&(A=W[0],N=W[1]);var z=this._bezierTo(A,N,R,T,E,C,e,n);l=l.concat(z),e.bezierReflectionPoint=[E+(E-R),C+(C-T)]}break}case'Q':case'q':{var D='q'===t.key;if(4<=t.data.length){var I=+t.data[0],F=+t.data[1],M=+t.data[2],B=+t.data[3];D&&(I+=e.x,M+=e.x,F+=e.y,B+=e.y);var q=1*(1+.2*n.roughness),U=1.5*(1+.22*n.roughness);l.push({op:'move',data:[e.x+this._getOffset(-q,q,n),e.y+this._getOffset(-q,q,n)]});var j=[M+this._getOffset(-q,q,n),B+this._getOffset(-q,q,n)];l.push({op:'qcurveTo',data:[I+this._getOffset(-q,q,n),F+this._getOffset(-q,q,n),j[0],j[1]]}),l.push({op:'move',data:[e.x+this._getOffset(-U,U,n),e.y+this._getOffset(-U,U,n)]}),j=[M+this._getOffset(-U,U,n),B+this._getOffset(-U,U,n)],l.push({op:'qcurveTo',data:[I+this._getOffset(-U,U,n),F+this._getOffset(-U,U,n),j[0],j[1]]}),e.setPosition(j[0],j[1]),e.quadReflectionPoint=[M+(M-I),B+(B-F)]}break}case'T':case't':{var f='t'===t.key;if(2<=t.data.length){var V=+t.data[0],X=+t.data[1];f&&(V+=e.x,X+=e.y);var G=V,H=X,$=a?a.key:'',W=null;('q'==$||'Q'==$||'t'==$||'T'==$)&&(W=e.quadReflectionPoint),W&&(G=W[0],H=W[1]);var Q=1*(1+.2*n.roughness),Z=1.5*(1+.22*n.roughness);l.push({op:'move',data:[e.x+this._getOffset(-Q,Q,n),e.y+this._getOffset(-Q,Q,n)]});var Y=[V+this._getOffset(-Q,Q,n),X+this._getOffset(-Q,Q,n)];l.push({op:'qcurveTo',data:[G+this._getOffset(-Q,Q,n),H+this._getOffset(-Q,Q,n),Y[0],Y[1]]}),l.push({op:'move',data:[e.x+this._getOffset(-Z,Z,n),e.y+this._getOffset(-Z,Z,n)]}),Y=[V+this._getOffset(-Z,Z,n),X+this._getOffset(-Z,Z,n)],l.push({op:'qcurveTo',data:[G+this._getOffset(-Z,Z,n),H+this._getOffset(-Z,Z,n),Y[0],Y[1]]}),e.setPosition(Y[0],Y[1]),e.quadReflectionPoint=[V+(V-G),X+(X-H)]}break}case'A':case'a':{var J='a'===t.key;if(7<=t.data.length){var K=+t.data[0],ee=+t.data[1],te=+t.data[2],ae=+t.data[3],ne=+t.data[4],le=+t.data[5],se=+t.data[6];if(J&&(le+=e.x,se+=e.y),le==e.x&&se==e.y)break;if(0==K||0==ee)l=l.concat(this._doubleLine(e.x,e.y,le,se,n)),e.setPosition(le,se);else for(var re=n.maxRandomnessOffset||0,ie=0;1>ie;ie++)for(var i,oe=new RoughArcConverter([e.x,e.y],[le,se],[K,ee],te,!!ae,!!ne),pe=oe.getNextSegment();pe;)i=this._bezierTo(pe.cp1[0],pe.cp1[1],pe.cp2[0],pe.cp2[1],pe.to[0],pe.to[1],e,n),l=l.concat(i),pe=oe.getNextSegment()}break}default:}return l}},{key:'_getOffset',value:function(e,t,a){return a.roughness*(Math.random()*(t-e)+e)}},{key:'_affine',value:function(e,t,a,n,l,s,r){return[-a*s-n*l+a+s*e+l*t,r*(a*l-n*s)+n+-r*l*e+r*s*t]}},{key:'_doubleLine',value:function(e,t,a,n,l){var s=this._line(e,t,a,n,l,!0,!1),r=this._line(e,t,a,n,l,!0,!0);return s.concat(r)}},{key:'_line',value:function(e,t,n,l,s,i,o){var p=a(e-n,2)+a(t-l,2),u=s.maxRandomnessOffset||0;100*(u*u)>p&&(u=r(p)/10);var h=u/2,d=.2+.2*Math.random(),g=s.bowing*s.maxRandomnessOffset*(l-t)/200,f=s.bowing*s.maxRandomnessOffset*(e-n)/200;g=this._getOffset(-g,g,s),f=this._getOffset(-f,f,s);var y=[];return i&&(o?y.push({op:'move',data:[e+this._getOffset(-h,h,s),t+this._getOffset(-h,h,s)]}):y.push({op:'move',data:[e+this._getOffset(-u,u,s),t+this._getOffset(-u,u,s)]})),o?y.push({op:'bcurveTo',data:[g+e+(n-e)*d+this._getOffset(-h,h,s),f+t+(l-t)*d+this._getOffset(-h,h,s),g+e+2*(n-e)*d+this._getOffset(-h,h,s),f+t+2*(l-t)*d+this._getOffset(-h,h,s),n+this._getOffset(-h,h,s),l+this._getOffset(-h,h,s)]}):y.push({op:'bcurveTo',data:[g+e+(n-e)*d+this._getOffset(-u,u,s),f+t+(l-t)*d+this._getOffset(-u,u,s),g+e+2*(n-e)*d+this._getOffset(-u,u,s),f+t+2*(l-t)*d+this._getOffset(-u,u,s),n+this._getOffset(-u,u,s),l+this._getOffset(-u,u,s)]}),y}},{key:'_curve',value:function(e,t,a){var n=e.length,l=[];if(3<n){var r=[],o=1-a.curveTightness;l.push({op:'move',data:[e[1][0],e[1][1]]});for(var s,p=1;p+2<n;p++)s=e[p],r[0]=[s[0],s[1]],r[1]=[s[0]+(o*e[p+1][0]-o*e[p-1][0])/6,s[1]+(o*e[p+1][1]-o*e[p-1][1])/6],r[2]=[e[p+1][0]+(o*e[p][0]-o*e[p+2][0])/6,e[p+1][1]+(o*e[p][1]-o*e[p+2][1])/6],r[3]=[e[p+1][0],e[p+1][1]],l.push({op:'bcurveTo',data:[r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1]]});if(t&&2===t.length){var i=a.maxRandomnessOffset;l.push({ops:'lineTo',data:[t[0]+this._getOffset(-i,i,a),t[1]+ +this._getOffset(-i,i,a)]})}}else 3===n?(l.push({op:'move',data:[e[1][0],e[1][1]]}),l.push({op:'bcurveTo',data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):2===n&&(l=l.concat(this._doubleLine(e[0][0],e[0][1],e[1][0],e[1][1],a)));return l}},{key:'_ellipse',value:function(e,t,a,r,i,p,u,h){var o=this._getOffset(-.5,.5,h)-s/2,d=[];d.push([this._getOffset(-p,p,h)+t+.9*r*n(o-e),this._getOffset(-p,p,h)+a+.9*i*l(o-e)]);for(var g=o;g<2*s+o-.01;g+=e)d.push([this._getOffset(-p,p,h)+t+r*n(g),this._getOffset(-p,p,h)+a+i*l(g)]);return d.push([this._getOffset(-p,p,h)+t+r*n(o+2*s+.5*u),this._getOffset(-p,p,h)+a+i*l(o+2*s+.5*u)]),d.push([this._getOffset(-p,p,h)+t+.98*r*n(o+u),this._getOffset(-p,p,h)+a+.98*i*l(o+u)]),d.push([this._getOffset(-p,p,h)+t+.9*r*n(o+.5*u),this._getOffset(-p,p,h)+a+.9*i*l(o+.5*u)]),this._curve(d,null,h)}},{key:'_curveWithOffset',value:function(e,t,a){for(var n=[[e[0][0]+this._getOffset(-t,t,a),e[0][1]+this._getOffset(-t,t,a)],[e[0][0]+this._getOffset(-t,t,a),e[0][1]+this._getOffset(-t,t,a)]],l=1;l<e.length;l++)n.push([e[l][0]+this._getOffset(-t,t,a),e[l][1]+this._getOffset(-t,t,a)]),l===e.length-1&&n.push([e[l][0]+this._getOffset(-t,t,a),e[l][1]+this._getOffset(-t,t,a)]);return this._curve(n,null,a)}},{key:'_arc',value:function(e,t,a,s,r,i,p,u,h){var o=i+this._getOffset(-.1,.1,h),d=[];d.push([this._getOffset(-u,u,h)+t+.9*s*n(o-e),this._getOffset(-u,u,h)+a+.9*r*l(o-e)]);for(var g=o;g<=p;g+=e)d.push([this._getOffset(-u,u,h)+t+s*n(g),this._getOffset(-u,u,h)+a+r*l(g)]);return d.push([t+s*n(p),a+r*l(p)]),d.push([t+s*n(p),a+r*l(p)]),this._curve(d,null,h)}},{key:'_getIntersectingLines',value:function(e,t,a){for(var n,l=[],s=new RoughSegment(e[0],e[1],e[2],e[3]),r=0;r<t.length;r++)n=new RoughSegment(t[r],a[r],t[(r+1)%t.length],a[(r+1)%t.length]),s.compare(n)==RoughSegmentRelation().INTERSECTS&&l.push([s.xi,s.yi]);return l}}]),e}();self._roughScript=self.document&&self.document.currentScript&&self.document.currentScript.src;var RoughGenerator=function(){function e(t,a){_classCallCheck(this,e),this.config=t||{},this.canvas=a,this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:'#000',strokeWidth:1,curveTightness:0,curveStepCount:9,fill:null,fillStyle:'hachure',fillWeight:-1,hachureAngle:-41,hachureGap:-1},this.config.options&&(this.defaultOptions=this._options(this.config.options))}var t=Math.round,a=Math.min;return _createClass(e,[{key:'_options',value:function(e){return e?_Object$assign({},this.defaultOptions,e):this.defaultOptions}},{key:'_drawable',value:function(e,t,a){return{shape:e,sets:t||[],options:a||this.defaultOptions}}},{key:'line',value:function(e,t,a,n,l){var s=this._options(l);return this._drawable('line',[this.lib.line(e,t,a,n,s)],s)}},{key:'rectangle',value:function(e,t,a,n,l){var s=this._options(l),r=[];if(s.fill){var i=[e,e+a,e+a,e],o=[t,t,t+n,t+n];'solid'===s.fillStyle?r.push(this.lib.solidFillShape(i,o,s)):r.push(this.lib.hachureFillShape(i,o,s))}return r.push(this.lib.rectangle(e,t,a,n,s)),this._drawable('rectangle',r,s)}},{key:'ellipse',value:function(e,t,a,n,l){var s=this._options(l),r=[];if(s.fill)if('solid'===s.fillStyle){var i=this.lib.ellipse(e,t,a,n,s);i.type='fillPath',r.push(i)}else r.push(this.lib.hachureFillEllipse(e,t,a,n,s));return r.push(this.lib.ellipse(e,t,a,n,s)),this._drawable('ellipse',r,s)}},{key:'circle',value:function(e,t,a,n){var l=this.ellipse(e,t,a,a,n);return l.shape='circle',l}},{key:'linearPath',value:function(e,t){var a=this._options(t);return this._drawable('linearPath',[this.lib.linearPath(e,!1,a)],a)}},{key:'polygon',value:function(e,t){var a=this._options(t),n=[];if(a.fill){var l,s=[],r=[],i=!0,o=!1;try{for(var u,h,p=_getIterator(e);!(i=(u=p.next()).done);i=!0)h=u.value,s.push(h[0]),r.push(h[1])}catch(e){o=!0,l=e}finally{try{!i&&p.return&&p.return()}finally{if(o)throw l}}'solid'===a.fillStyle?n.push(this.lib.solidFillShape(s,r,a)):n.push(this.lib.hachureFillShape(s,r,a))}return n.push(this.lib.linearPath(e,!0,a)),this._drawable('polygon',n,a)}},{key:'arc',value:function(e,t,a,n,l,s,r,i){var p=this._options(i),o=[];if(r&&p.fill)if('solid'===p.fillStyle){var u=this.lib.arc(e,t,a,n,l,s,!0,!1,p);u.type='fillPath',o.push(u)}else o.push(this.lib.hachureFillArc(e,t,a,n,l,s,p));return o.push(this.lib.arc(e,t,a,n,l,s,r,!0,p)),this._drawable('arc',o,p)}},{key:'curve',value:function(e,t){var a=this._options(t);return this._drawable('curve',[this.lib.curve(e,a)],a)}},{key:'path',value:function(e,t){var a=this._options(t),n=[];if(!e)return this._drawable('path',n,a);if(a.fill)if('solid'===a.fillStyle){n.push({type:'path2Dfill',path:e})}else{var l=this._computePathSize(e),s=[0,l[0],l[0],0],r=[0,0,l[1],l[1]],i=this.lib.hachureFillShape(s,r,a);i.type='path2Dpattern',i.size=l,i.path=e,n.push(i)}return n.push(this.lib.svgPath(e,a)),this._drawable('path',n,a)}},{key:'toPaths',value:function(e){var a,n=e.sets||[],l=e.options||this.defaultOptions,s=[],r=!0,i=!1;try{for(var o,p=_getIterator(n);!(r=(o=p.next()).done);r=!0){var u=o.value,h=null;switch(u.type){case'path':h={d:this.opsToPath(u),stroke:l.stroke,strokeWidth:l.strokeWidth,fill:'none'};break;case'fillPath':h={d:this.opsToPath(u),stroke:'none',strokeWidth:0,fill:l.fill};break;case'fillSketch':h=this._fillSketch(u,l);break;case'path2Dfill':h={d:u.path,stroke:'none',strokeWidth:0,fill:l.fill};break;case'path2Dpattern':{var d=u.size,g={x:0,y:0,width:1,height:1,viewBox:'0 0 '+t(d[0])+' '+t(d[1]),patternUnits:'objectBoundingBox',path:this._fillSketch(u,l)};h={d:u.path,stroke:'none',strokeWidth:0,pattern:g};break}}h&&s.push(h)}}catch(e){i=!0,a=e}finally{try{!r&&p.return&&p.return()}finally{if(i)throw a}}return s}},{key:'_fillSketch',value:function(e,t){var a=t.fillWeight;return 0>a&&(a=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill,strokeWidth:a,fill:'none'}}},{key:'opsToPath',value:function(e){var t,a='',n=!0,l=!1;try{for(var s,r=_getIterator(e.ops);!(n=(s=r.next()).done);n=!0){var i=s.value,o=i.data;switch(i.op){case'move':a+='M'+o[0]+' '+o[1]+' ';break;case'bcurveTo':a+='C'+o[0]+' '+o[1]+', '+o[2]+' '+o[3]+', '+o[4]+' '+o[5]+' ';break;case'qcurveTo':a+='Q'+o[0]+' '+o[1]+', '+o[2]+' '+o[3]+' ';break;case'lineTo':a+='L'+o[0]+' '+o[1]+' ';}}}catch(e){l=!0,t=e}finally{try{!n&&r.return&&r.return()}finally{if(l)throw t}}return a.trim()}},{key:'_computePathSize',value:function(e){var t=[0,0];if(self.document)try{var n='http://www.w3.org/2000/svg',l=self.document.createElementNS(n,'svg');l.setAttribute('width','0'),l.setAttribute('height','0');var s=self.document.createElementNS(n,'path');s.setAttribute('d',e),l.appendChild(s),self.document.body.appendChild(l);var r=s.getBBox();r&&(t[0]=r.width||0,t[1]=r.height||0),self.document.body.removeChild(l)}catch(e){}var i=this._canvasSize();return t[0]*t[1]||(t=i),t[0]=a(t[0],i[0]),t[1]=a(t[1],i[1]),t}},{key:'_canvasSize',value:function(){var e=function(e){return e&&'object'===('undefined'==typeof e?'undefined':_typeof(e))&&e.baseVal&&e.baseVal.value?e.baseVal.value:e||100};return this.canvas?[e(this.canvas.width),e(this.canvas.height)]:[100,100]}},{key:'lib',get:function(){if(!this._renderer)if(self&&self.workly&&this.config.async&&!this.config.noWorker){var e=Function.prototype.toString,t=this.config.worklyURL||'https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js',a=this.config.roughURL||self._roughScript;if(a&&t){var n=URL.createObjectURL(new Blob(['importScripts(\''+t+'\', \''+a+'\');\nworkly.expose(self.rough.createRenderer());']));this._renderer=workly.proxy(n)}else this._renderer=new RoughRenderer}else this._renderer=new RoughRenderer;return this._renderer}}]),e}(),RoughGeneratorAsync=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||_Object$getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:'line',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._options(s),e.t0=this,e.next=4,this.lib.line(t,a,n,l,r);case 4:return e.t1=e.sent,e.t2=[e.t1],e.t3=r,e.abrupt('return',e.t0._drawable.call(e.t0,'line',e.t2,e.t3));case 8:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'rectangle',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r,i,o,p;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._options(s),i=[],!r.fill){e.next=18;break}if(o=[t,t+n,t+n,t],p=[a,a,a+l,a+l],'solid'!==r.fillStyle){e.next=13;break}return e.t0=i,e.next=9,this.lib.solidFillShape(o,p,r);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=18;break;case 13:return e.t2=i,e.next=16,this.lib.hachureFillShape(o,p,r);case 16:e.t3=e.sent,e.t2.push.call(e.t2,e.t3);case 18:return e.t4=i,e.next=21,this.lib.rectangle(t,a,n,l,r);case 21:return e.t5=e.sent,e.t4.push.call(e.t4,e.t5),e.abrupt('return',this._drawable('rectangle',i,r));case 24:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'ellipse',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r,i,o;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._options(s),i=[],!r.fill){e.next=16;break}if('solid'!==r.fillStyle){e.next=11;break}return e.next=6,this.lib.ellipse(t,a,n,l,r);case 6:o=e.sent,o.type='fillPath',i.push(o),e.next=16;break;case 11:return e.t0=i,e.next=14,this.lib.hachureFillEllipse(t,a,n,l,r);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:return e.t2=i,e.next=19,this.lib.ellipse(t,a,n,l,r);case 19:return e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.abrupt('return',this._drawable('ellipse',i,r));case 22:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'circle',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l){var s;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ellipse(t,a,n,n,l);case 2:return s=e.sent,s.shape='circle',e.abrupt('return',s);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'linearPath',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._options(a),e.t0=this,e.next=4,this.lib.linearPath(t,!1,n);case 4:return e.t1=e.sent,e.t2=[e.t1],e.t3=n,e.abrupt('return',e.t0._drawable.call(e.t0,'linearPath',e.t2,e.t3));case 8:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'polygon',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n,l,s,r,i,o,u,h,d,g;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._options(a),l=[],!n.fill){e.next=36;break}for(s=[],r=[],i=!0,o=!1,u=void 0,e.prev=7,h=_getIterator(t);!(i=(d=h.next()).done);i=!0)g=d.value,s.push(g[0]),r.push(g[1]);e.next=15;break;case 11:e.prev=11,e.t0=e['catch'](7),o=!0,u=e.t0;case 15:e.prev=15,e.prev=16,!i&&h.return&&h.return();case 18:if(e.prev=18,!o){e.next=21;break}throw u;case 21:return e.finish(18);case 22:return e.finish(15);case 23:if('solid'!==n.fillStyle){e.next=31;break}return e.t1=l,e.next=27,this.lib.solidFillShape(s,r,n);case 27:e.t2=e.sent,e.t1.push.call(e.t1,e.t2),e.next=36;break;case 31:return e.t3=l,e.next=34,this.lib.hachureFillShape(s,r,n);case 34:e.t4=e.sent,e.t3.push.call(e.t3,e.t4);case 36:return e.t5=l,e.next=39,this.lib.linearPath(t,!0,n);case 39:return e.t6=e.sent,e.t5.push.call(e.t5,e.t6),e.abrupt('return',this._drawable('polygon',l,n));case 42:case'end':return e.stop();}},e,this,[[7,11,15,23],[16,,18,22]])}));return function(){return e.apply(this,arguments)}}()},{key:'arc',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s,r,i,p){var u,o,h;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u=this._options(p),o=[],!(i&&u.fill)){e.next=16;break}if('solid'!==u.fillStyle){e.next=11;break}return e.next=6,this.lib.arc(t,a,n,l,s,r,!0,!1,u);case 6:h=e.sent,h.type='fillPath',o.push(h),e.next=16;break;case 11:return e.t0=o,e.next=14,this.lib.hachureFillArc(t,a,n,l,s,r,u);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:return e.t2=o,e.next=19,this.lib.arc(t,a,n,l,s,r,i,!0,u);case 19:return e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.abrupt('return',this._drawable('arc',o,u));case 22:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'curve',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._options(a),e.t0=this,e.next=4,this.lib.curve(t,n);case 4:return e.t1=e.sent,e.t2=[e.t1],e.t3=n,e.abrupt('return',e.t0._drawable.call(e.t0,'curve',e.t2,e.t3));case 8:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'path',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n,l,s,r,i,o,p;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._options(a),l=[],t){e.next=4;break}return e.abrupt('return',this._drawable('path',l,n));case 4:if(!n.fill){e.next=20;break}if('solid'!==n.fillStyle){e.next=10;break}s={type:'path2Dfill',path:t},l.push(s),e.next=20;break;case 10:return r=this._computePathSize(t),i=[0,r[0],r[0],0],o=[0,0,r[1],r[1]],e.next=15,this.lib.hachureFillShape(i,o,n);case 15:p=e.sent,p.type='path2Dpattern',p.size=r,p.path=t,l.push(p);case 20:return e.t0=l,e.next=23,this.lib.svgPath(t,n);case 23:return e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.abrupt('return',this._drawable('path',l,n));case 26:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(RoughGenerator),RoughCanvas=function(){function e(t,a){_classCallCheck(this,e),this.canvas=t,this.ctx=this.canvas.getContext('2d'),this._init(a)}return _createClass(e,[{key:'_init',value:function(e){this.gen=new RoughGenerator(e,this.canvas)}},{key:'line',value:function(e,t,a,n,l){var s=this.gen.line(e,t,a,n,l);return this.draw(s),s}},{key:'rectangle',value:function(e,t,a,n,l){var s=this.gen.rectangle(e,t,a,n,l);return this.draw(s),s}},{key:'ellipse',value:function(e,t,a,n,l){var s=this.gen.ellipse(e,t,a,n,l);return this.draw(s),s}},{key:'circle',value:function(e,t,a,n){var l=this.gen.circle(e,t,a,n);return this.draw(l),l}},{key:'linearPath',value:function(e,t){var a=this.gen.linearPath(e,t);return this.draw(a),a}},{key:'polygon',value:function(e,t){var a=this.gen.polygon(e,t);return this.draw(a),a}},{key:'arc',value:function(e,t,a,n,l,s,r,i){var o=this.gen.arc(e,t,a,n,l,s,r,i);return this.draw(o),o}},{key:'curve',value:function(e,t){var a=this.gen.curve(e,t);return this.draw(a),a}},{key:'path',value:function(e,t){var a=this.gen.path(e,t);return this.draw(a),a}},{key:'draw',value:function(e){var t,a=e.sets||[],n=e.options||this.gen.defaultOptions,l=this.ctx,s=!0,r=!1;try{for(var i,o,p=_getIterator(a);!(s=(i=p.next()).done);s=!0)switch(o=i.value,o.type){case'path':l.save(),l.strokeStyle=n.stroke,l.lineWidth=n.strokeWidth,this._drawToContext(l,o),l.restore();break;case'fillPath':l.save(),l.fillStyle=n.fill,this._drawToContext(l,o,n),l.restore();break;case'fillSketch':this._fillSketch(l,o,n);break;case'path2Dfill':{this.ctx.save(),this.ctx.fillStyle=n.fill;var u=new Path2D(o.path);this.ctx.fill(u),this.ctx.restore();break}case'path2Dpattern':{var h=o.size,d=document.createElement('canvas'),g=d.getContext('2d'),f=this._computeBBox(o.path);f&&(f.width||f.height)?(d.width=this.canvas.width,d.height=this.canvas.height,g.translate(f.x||0,f.y||0)):(d.width=h[0],d.height=h[1]),this._fillSketch(g,o,n),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(d,'repeat');var y=new Path2D(o.path);this.ctx.fill(y),this.ctx.restore();break}}}catch(e){r=!0,t=e}finally{try{!s&&p.return&&p.return()}finally{if(r)throw t}}}},{key:'_computeBBox',value:function(e){if(self.document)try{var t='http://www.w3.org/2000/svg',a=self.document.createElementNS(t,'svg');a.setAttribute('width','0'),a.setAttribute('height','0');var n=self.document.createElementNS(t,'path');n.setAttribute('d',e),a.appendChild(n),self.document.body.appendChild(a);var l=n.getBBox();return self.document.body.removeChild(a),l}catch(e){}return null}},{key:'_fillSketch',value:function(e,t,a){var n=a.fillWeight;0>n&&(n=a.strokeWidth/2),e.save(),e.strokeStyle=a.fill,e.lineWidth=n,this._drawToContext(e,t),e.restore()}},{key:'_drawToContext',value:function(e,t){e.beginPath();var a,n=!0,l=!1;try{for(var s,r=_getIterator(t.ops);!(n=(s=r.next()).done);n=!0){var i=s.value,o=i.data;switch(i.op){case'move':e.moveTo(o[0],o[1]);break;case'bcurveTo':e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case'qcurveTo':e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case'lineTo':e.lineTo(o[0],o[1]);}}}catch(e){l=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(l)throw a}}'fillPath'===t.type?e.fill():e.stroke()}},{key:'generator',get:function(){return this.gen}}],[{key:'createRenderer',value:function(){return new RoughRenderer}}]),e}(),RoughCanvasAsync=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||_Object$getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:'_init',value:function(e){this.gen=new RoughGeneratorAsync(e,this.canvas)}},{key:'line',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.line(t,a,n,l,s);case 2:return r=e.sent,this.draw(r),e.abrupt('return',r);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'rectangle',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.rectangle(t,a,n,l,s);case 2:return r=e.sent,this.draw(r),e.abrupt('return',r);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'ellipse',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.ellipse(t,a,n,l,s);case 2:return r=e.sent,this.draw(r),e.abrupt('return',r);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'circle',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l){var s;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.circle(t,a,n,l);case 2:return s=e.sent,this.draw(s),e.abrupt('return',s);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'linearPath',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.linearPath(t,a);case 2:return n=e.sent,this.draw(n),e.abrupt('return',n);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'polygon',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.polygon(t,a);case 2:return n=e.sent,this.draw(n),e.abrupt('return',n);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'arc',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s,r,i,o){var p;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.arc(t,a,n,l,s,r,i,o);case 2:return p=e.sent,this.draw(p),e.abrupt('return',p);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'curve',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.curve(t,a);case 2:return n=e.sent,this.draw(n),e.abrupt('return',n);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'path',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.path(t,a);case 2:return n=e.sent,this.draw(n),e.abrupt('return',n);case 5:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(RoughCanvas),RoughSVG=function(){function e(t,a){_classCallCheck(this,e),this.svg=t,this._init(a)}var t=Math.round;return _createClass(e,[{key:'_init',value:function(e){this.gen=new RoughGenerator(e,this.svg)}},{key:'line',value:function(e,t,a,n,l){var s=this.gen.line(e,t,a,n,l);return this.draw(s)}},{key:'rectangle',value:function(e,t,a,n,l){var s=this.gen.rectangle(e,t,a,n,l);return this.draw(s)}},{key:'ellipse',value:function(e,t,a,n,l){var s=this.gen.ellipse(e,t,a,n,l);return this.draw(s)}},{key:'circle',value:function(e,t,a,n){var l=this.gen.circle(e,t,a,n);return this.draw(l)}},{key:'linearPath',value:function(e,t){var a=this.gen.linearPath(e,t);return this.draw(a)}},{key:'polygon',value:function(e,t){var a=this.gen.polygon(e,t);return this.draw(a)}},{key:'arc',value:function(e,t,a,n,l,s,r,i){var o=this.gen.arc(e,t,a,n,l,s,r,i);return this.draw(o)}},{key:'curve',value:function(e,t){var a=this.gen.curve(e,t);return this.draw(a)}},{key:'path',value:function(e,t){var a=this.gen.path(e,t);return this.draw(a)}},{key:'draw',value:function(e){var a,n=e.sets||[],l=e.options||this.gen.defaultOptions,s=this.svg.ownerDocument||document,r=s.createElementNS('http://www.w3.org/2000/svg','g'),i=!0,o=!1;try{for(var p,u=_getIterator(n);!(i=(p=u.next()).done);i=!0){var h=p.value,d=null;switch(h.type){case'path':{d=s.createElementNS('http://www.w3.org/2000/svg','path'),d.setAttribute('d',this._opsToPath(h)),d.style.stroke=l.stroke,d.style.strokeWidth=l.strokeWidth,d.style.fill='none';break}case'fillPath':{d=s.createElementNS('http://www.w3.org/2000/svg','path'),d.setAttribute('d',this._opsToPath(h)),d.style.stroke='none',d.style.strokeWidth=0,d.style.fill=l.fill;break}case'fillSketch':{d=this._fillSketch(s,h,l);break}case'path2Dfill':{d=s.createElementNS('http://www.w3.org/2000/svg','path'),d.setAttribute('d',h.path),d.style.stroke='none',d.style.strokeWidth=0,d.style.fill=l.fill;break}case'path2Dpattern':{var g=h.size,f=s.createElementNS('http://www.w3.org/2000/svg','pattern'),y='rough-'+Math.floor(Math.random()*(_Number$MAX_SAFE_INTEGER||999999));f.setAttribute('id',y),f.setAttribute('x',0),f.setAttribute('y',0),f.setAttribute('width',1),f.setAttribute('height',1),f.setAttribute('height',1),f.setAttribute('viewBox','0 0 '+t(g[0])+' '+t(g[1])),f.setAttribute('patternUnits','objectBoundingBox');var c=this._fillSketch(s,h,l);f.appendChild(c),this.defs.appendChild(f),d=s.createElementNS('http://www.w3.org/2000/svg','path'),d.setAttribute('d',h.path),d.style.stroke='none',d.style.strokeWidth=0,d.style.fill='url(#'+y+')';break}}d&&r.appendChild(d)}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return r}},{key:'_fillSketch',value:function(e,t,a){var n=a.fillWeight;0>n&&(n=a.strokeWidth/2);var l=e.createElementNS('http://www.w3.org/2000/svg','path');return l.setAttribute('d',this._opsToPath(t)),l.style.stroke=a.fill,l.style.strokeWidth=n,l.style.fill='none',l}},{key:'_opsToPath',value:function(e){return this.gen.opsToPath(e)}},{key:'generator',get:function(){return this.gen}},{key:'defs',get:function(){if(!this._defs){var e=this.svg.ownerDocument||document,t=e.createElementNS('http://www.w3.org/2000/svg','defs');this.svg.firstChild?this.svg.insertBefore(t,this.svg.firstChild):this.svg.appendChild(t),this._defs=t}return this._defs}}]),e}(),RoughSVGAsync=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||_Object$getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:'_init',value:function(e){this.gen=new RoughGeneratorAsync(e,this.svg)}},{key:'line',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.line(t,a,n,l,s);case 2:return r=e.sent,e.abrupt('return',this.draw(r));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'rectangle',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.rectangle(t,a,n,l,s);case 2:return r=e.sent,e.abrupt('return',this.draw(r));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'ellipse',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s){var r;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.ellipse(t,a,n,l,s);case 2:return r=e.sent,e.abrupt('return',this.draw(r));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'circle',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l){var s;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.circle(t,a,n,l);case 2:return s=e.sent,e.abrupt('return',this.draw(s));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'linearPath',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.linearPath(t,a);case 2:return n=e.sent,e.abrupt('return',this.draw(n));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'polygon',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.polygon(t,a);case 2:return n=e.sent,e.abrupt('return',this.draw(n));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'arc',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a,n,l,s,r,i,o){var p;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.arc(t,a,n,l,s,r,i,o);case 2:return p=e.sent,e.abrupt('return',this.draw(p));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'curve',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.curve(t,a);case 2:return n=e.sent,e.abrupt('return',this.draw(n));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:'path',value:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,a){var n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gen.path(t,a);case 2:return n=e.sent,e.abrupt('return',this.draw(n));case 4:case'end':return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(RoughSVG),index={canvas:function(e,t){return t&&t.async?new RoughCanvasAsync(e,t):new RoughCanvas(e,t)},svg:function(e,t){return t&&t.async?new RoughSVGAsync(e,t):new RoughSVG(e,t)},createRenderer:function(){return RoughCanvas.createRenderer()},generator:function(e,t){return e&&e.async?new RoughGeneratorAsync(e,t):new RoughGenerator(e,t)}};module.exports=index;